{"version":3,"file":"chromatic","sources":["../src/errors.ts","../src/utils.ts","../src/default-formatters.ts","../src/formats.ts","../src/value.ts","../src/terminal.ts","../src/color-functions.ts","../src/value-parser.ts","../src/formats-generic.ts","../src/formats-web.ts","../src/formats-styleguide.ts","../src/chromatic.ts","../src/chromatic-cli.ts"],"sourcesContent":["export enum ErrorCode {\n  NoError = 0,\n  SyntaxError,\n\n  UnexpectedOpenBracket,\n  ExpectedCloseBracket,\n  ExpectedCloseCurlyBracket,\n  ExpectedOpenParen,\n  ExpectedCloseParen,\n  ExpectedQuote,\n\n  UnknownToken,\n  UnknownUnit,\n\n  UnknownFunction,\n  MissingArgument,\n  ExpectedArgument,\n  TooManyArguments,\n  InvalidArgument,\n\n  ExpectedOperand,\n  InvalidOperand,\n  InvalidUnaryOperand,\n\n  ExpectedIntegerIndex,\n\n  CircularDefinition,\n  UnexpectedTokensArray,\n  UnexpectedTokensType,\n  InvalidTokenName,\n  InvalidTokenValue,\n  InconsistentTokenType,\n  UnknownFormat,\n  UnknownValueFormatter,\n  UnknownNameFormatter,\n}\n\nconst ERRORS = {\n  [ErrorCode.SyntaxError]: 'Syntax error',\n\n  [ErrorCode.UnexpectedOpenBracket]: 'Unexpected `[`',\n  [ErrorCode.ExpectedCloseBracket]: 'Expected `]`',\n  [ErrorCode.ExpectedCloseCurlyBracket]: 'Expected `}`',\n  [ErrorCode.ExpectedOpenParen]: 'Expected `(`',\n  [ErrorCode.ExpectedCloseParen]: 'Expected `)`',\n  [ErrorCode.ExpectedQuote]: 'Expected `\"`',\n\n  [ErrorCode.UnknownToken]: 'Unknown token `%1`%2',\n\n  [ErrorCode.UnknownUnit]: 'Unknown unit `%1`',\n\n  [ErrorCode.UnknownFunction]: 'Unknown function `%1`%2',\n  [ErrorCode.MissingArgument]: 'Missing argument %1 of `%2` of type `%3`',\n  [ErrorCode.ExpectedArgument]:\n    'Expected argument %1 of `%2` to be of type `%3`',\n  [ErrorCode.TooManyArguments]: 'Too many arguments for function `%1(%2)`',\n  [ErrorCode.InvalidArgument]: 'Invalid argument `%2` for function `%1`%3',\n\n  [ErrorCode.ExpectedOperand]: 'Expected operand',\n  [ErrorCode.InvalidOperand]: 'Invalid operand',\n  [ErrorCode.InvalidUnaryOperand]: 'Invalid operand',\n\n  [ErrorCode.CircularDefinition]: 'Circular definition of the \"%1\" token',\n  [ErrorCode.UnexpectedTokensArray]:\n    'The \"tokens\" property is an array. It should be a key/value map of tokens.\\n%1',\n  [ErrorCode.UnexpectedTokensType]:\n    'The \"tokens\" property should be a key/value map of tokens.',\n  [ErrorCode.InvalidTokenName]:\n    'Invalid token name \"%1\": it must only contain digits, letters, \"_\" and \"-\"',\n  [ErrorCode.InvalidTokenValue]:\n    'The \"%1\" token is invalid. If using a YAML file, make sure RGB hex values are within quotes',\n  [ErrorCode.InconsistentTokenType]:\n    'Inconsistent token type in valus of token \"%1\"',\n  [ErrorCode.UnknownFormat]: 'Unknown format \"%1\"%2',\n  [ErrorCode.UnknownValueFormatter]: 'Unknown value formatter \"%1\"%2',\n  [ErrorCode.UnknownNameFormatter]: 'Unknown name formatter \"%1\"%2',\n  [ErrorCode.ExpectedIntegerIndex]: 'Expected array index to be a number',\n};\n\nexport class SyntaxError extends Error {\n  code: ErrorCode;\n  args: string[];\n  constructor(code: ErrorCode, ...args: string[]) {\n    super(ERRORS[code]);\n    this.code = code;\n    this.args = args;\n  }\n}\nexport function throwErrorIf(\n  condition: boolean,\n  code: number,\n  ...args: string[]\n): void {\n  if (condition) throwErrorWithContext(undefined, code, ...args);\n}\n\nexport function throwError(code: number, ...args: string[]): void {\n  throwErrorWithContext(undefined, code, ...args);\n}\n\nexport function throwErrorWithContext(\n  context: string[],\n  code: number,\n  ...args: string[]\n): void {\n  let message = '';\n  if (process.env.TEST) {\n    message = '[ERR] ' + (ErrorCode[code] ?? code);\n  } else {\n    if (context) message = context.join('\\n') + '\\n';\n    message += ERRORS[code];\n    args.forEach((val, index) => {\n      message = message.replace(new RegExp(`%${index + 1}`, 'g'), val);\n    });\n  }\n  throw new Error(message);\n}\n","const stringSimilarity = require('string-similarity');\n\nexport function findClosestKey(\n  key: string,\n  o: Record<string, unknown> | Map<string, unknown> | string[]\n): string {\n  if (!key || !o) return '';\n  let keys: string[];\n  if (o instanceof Map) {\n    keys = Array.from(o.keys());\n  } else if (Array.isArray(o)) {\n    keys = o;\n  } else {\n    keys = Object.keys(o);\n  }\n  if (keys.length === 0) return '';\n  const result = stringSimilarity.findBestMatch(key, keys);\n  return result.bestMatch.rating > 0.1 ? result.bestMatch.target : '';\n}\n\nexport function getSuggestion(\n  key: string,\n  o: Record<string, unknown> | Map<string, unknown> | string[]\n): string {\n  const alt = findClosestKey(key, o);\n  return alt ? `. Did you mean \"${alt}\"?` : '';\n}\n","import { Value } from './value';\n\nexport const DefaultFormatters = {\n  nameFormatters: {\n    camelcase: (name: string, theme: string): string =>\n      (name + !theme ? '' : '.' + theme)\n        .toLowerCase()\n        .replace(/(?:^\\w|[A-Z]|\\b\\w)/g, (ltr, idx) =>\n          idx === 0 ? ltr.toLowerCase() : ltr.toUpperCase()\n        )\n        .replace(/\\s+/g, ''),\n    kebabcase: (name: string, theme: string): string =>\n      (name + !theme ? '' : '.' + theme)\n        .match(/[A-Z]{2,}(?=[A-Z][a-z0-9]*|\\b)|[A-Z]?[a-z0-9]*|[A-Z]|[0-9]+/g)\n        .filter(Boolean)\n        .map((x) => x.toLowerCase())\n        .join('-'),\n    uppercase: (name: string, theme: string): string =>\n      (name + !theme ? '' : '.' + theme).toUpperCase(),\n    lowercase: (name: string, theme: string): string =>\n      (name + !theme ? '' : '.' + theme).toLowerCase(),\n  },\n  handlebarsHelpers: {\n    'uppercase': (s: string): string => s.toUpperCase(),\n\n    /**\n     * Replace any invalid characters with a '-'\n     * \"{{sanitizeCssPropertyName \"foo.bar\"}} -> \"foo-bar\"\n     */\n\n    'sanitizeCssPropertyName': (s: string): string =>\n      s.replace(/[^a-zA-Z0-9_-]/g, '-'),\n\n    /**\n     * Return a CSS formatted representation of the value\n     */\n\n    'cssValue': (v: Value): string => v?.css() ?? '[MISSING VALUE]',\n\n    /**\n     * In a list (\\n separated lines), remove the trailing \",\"\n     * on the last line that has one.\n     * This is useful for JSON lists for example.\n     */\n\n    'remove-last-comma': function (context: {\n      fn: (arg0: any) => string;\n    }): string {\n      const lines = context.fn(this).split('\\n');\n      const lastCommaLine = lines.reduce(\n        (acc, v, idx) => (/,$/.test(v) ? idx : acc),\n        -1\n      );\n      return lines\n        .map((line, idx) => (idx !== lastCommaLine ? line : line.slice(0, -1)))\n        .join('\\n');\n    },\n\n    /** Usage:\n     * {{comment property}} -> \"/* value of property * /\"\n     * {{comment property \"# \"}} -> \"# value of property\"\n     * {{comment property \"    # \"}}} -> \"    # value of property\"\n     * {{comment property \"//}} -> \"// value of property\"\n     */\n\n    'comment': function (s: string, format = '/* */'): string {\n      if (typeof s !== 'string') {\n        return this.comment;\n      }\n      if (!s) return '';\n      // If there's only one argument passed to the helper\n      // (i.e. {{comment foo}}) the second argument passed in is a context\n      // object\n      if (typeof format !== 'string') format = '/* */';\n      const prefix = format.match(/(\\s*)/)?.[1] ?? '';\n      const suffix = format.slice(prefix.length);\n      let [open, close] = suffix.split(' ');\n      if (open === '/*' && close === '*/') {\n        return (\n          prefix +\n          '/* ' +\n          s.split('\\n').join('\\n' + prefix + ' * ') +\n          '\\n' +\n          prefix +\n          ' */'\n        );\n      }\n      if (!close) {\n        open = format.slice(prefix.length);\n        close = '';\n      }\n      return (\n        prefix + open + s.split('\\n').join((close ?? '') + '\\n' + prefix + open)\n      );\n    },\n  },\n};\n","import { Value, ValueType } from './value';\n\nexport interface TokenDefinition {\n  value: {\n    /* Value for the base theme */\n    _?: string;\n\n    /* Value for the other themes */\n    [theme: string]: string;\n  };\n\n  /** Type hint. The type is usually inferred from the value. */\n  type?: ValueType;\n\n  /* Single line, plain text recommended */\n  /* Output in the generated files */\n\n  comment?: string;\n\n  /* Multiple lines or paragraphs. Markdown recommended */\n  /* Output in the generated documentation */\n  remarks?: string;\n\n  /* When this token has been deprecated, what replaces it, or when will it be removed. */\n  deprecated?: string;\n  [key: string]: unknown;\n}\n\nexport interface TokenGroupInfo {\n  name?: string;\n  comment?: string;\n  remarks?: string;\n}\n\nexport interface RenderContext {\n  /** The path of this output file*/\n  filepath: string;\n\n  /** Header for this file. May be multiple lines. */\n  fileHeader: string;\n\n  /** For each token group, */\n  groups: {\n    /** ID, for example: \"brand.marketing\" */\n    groupId: string;\n    /** Info, such as comments, etc.. about the group */\n    groupInfo: TokenGroupInfo;\n    /** Array of tokens in this group */\n    tokens: {\n      /** ID, such as \"semantic.error\" */\n      tokenId: string;\n      /** Info, such as comments, etc... about the token */\n      tokenDefinition: TokenDefinition;\n      /** Array of themes supported by the token */\n      themes: {\n        theme: string;\n        /** Token with theme, for example \"semantic.error.dark\" */\n        tokenName: string;\n        /** The Value for this token/theme */\n        tokenValue: Value;\n      }[];\n    }[];\n  }[];\n\n  /** For each themes */\n  themes: {\n    theme: string;\n    isDefaultTheme: boolean; // True if theme === '_', but stored as a\n    // boolean here for ease of access in handlerbars templates\n    tokens: {\n      /** ID, such as \"semantic.error\" */\n      tokenId: string;\n      /** Info, such as comments, etc... about the token */\n      tokenDefinition: TokenDefinition;\n      /** Token with theme, for example \"semantic.error.dark\" */\n      tokenName: string;\n      /** The Value for this token/theme */\n      tokenValue: Value;\n    }[];\n  }[];\n  renderTemplate: (template: string, context: any) => string;\n}\n\nexport interface Format {\n  /** The name of a format this format is an extension  of (inherits from) */\n  extends?: string;\n\n  /** Preferred file extension for the generated file(s) for this format,\n   * for example \".txt\"\n   */\n  ext?: string;\n\n  formatFilename?: ({\n    theme,\n    basename,\n  }: {\n    theme: string;\n    basename: string;\n  }) => string;\n\n  /** Header included at the begining of generated files,\n   * such as a warning about not modifying the file or a copyright notice */\n  fileHeader?: string;\n\n  handlebarsHelpers?: { [helper: string]: (...args: any[]) => string };\n\n  render?: (context: RenderContext) => string;\n  [key: string]: unknown;\n}\n\nexport const DEFAULT_FILE_HEADER = `\nThis file was automatically generated by Chromatic.\nDo not edit.\nGenerated ${new Date().toISOString()}\n`;\n","const colorName = require('color-name');\n\nimport { throwError, ErrorCode, SyntaxError } from './errors';\n\nexport type ValueType =\n  | 'string'\n  | 'number'\n  | 'percentage'\n  | 'angle'\n  | 'color'\n  | 'length'\n  | 'time'\n  | 'frequency'\n  | 'array';\n\n/**\n * Those are relative units that can't be evaluated statically, as they\n * depend on the rendering environment (the size of the base font of the\n * document, the metrics of the current font, the dimension of the view port.\n * However, it is possible to provide values for those to valueParser,\n * in which case they will get evaluated.\n */\n\nexport interface BaseLengthUnits {\n  rem?: number;\n  em?: number;\n  ex?: number;\n  ch?: number;\n  vh?: number;\n  vw?: number;\n}\n\nexport function clampByte(v: number): number {\n  if (v < 0) return 0;\n  if (v > 255) return 255;\n  return Math.round(v);\n}\n\nexport class Value {\n  private source = '';\n  css(): string {\n    return '';\n  }\n  type(): ValueType {\n    return undefined;\n  }\n  canonicalScalar(): number {\n    return 0;\n  }\n  getSource(): string {\n    return this.source;\n  }\n  setSource(source: string): void {\n    this.source = source;\n  }\n  equals(v: Value): boolean {\n    return (\n      this.type() === v.type() && this.canonicalScalar() == v.canonicalScalar()\n    );\n  }\n  [key: string]: unknown;\n}\n\nexport type LengthUnit =\n  | 'px'\n  | 'cm'\n  | 'mm'\n  | 'Q'\n  | 'in'\n  | 'pc'\n  | 'pt'\n  | 'rem'\n  | 'em'\n  | 'ex'\n  | 'ch'\n  | 'vw'\n  | 'vh'\n  | 'vmin'\n  | 'vmax'\n  | 'multi';\n\nexport type AngleUnit = 'deg' | 'grad' | 'rad' | 'degree' | 'turn';\n\nexport type TimeUnit = 's' | 'ms';\n\nexport type FrequencyUnit = 'hz' | 'khz';\n\nexport function roundTo(num: number, precision: number): number {\n  return (\n    Math.round(num * Math.pow(10, precision) + 1e-14) / Math.pow(10, precision)\n  );\n}\n\nexport class Percentage extends Value {\n  value: number; /* [0..100] */\n  constructor(from: number) {\n    super();\n    this.value = from;\n  }\n  css(): string {\n    return roundTo(this.value, 2) + '%';\n  }\n  type(): ValueType {\n    return 'percentage';\n  }\n  canonicalScalar(): number {\n    return this.value / 100;\n  }\n  equals(v: Value): boolean {\n    if (isLength(v)) {\n      const v1 = promoteToMulti(this);\n      const v2 = promoteToMulti(v);\n      return [...Object.keys(v1.value), ...Object.keys(v2.value)].every(\n        (x) => v1.value[x] === v2.value[x]\n      );\n    }\n\n    return false;\n  }\n}\n\nexport class Angle extends Value {\n  value: number;\n  unit: AngleUnit;\n  constructor(from: number, unit: AngleUnit) {\n    super();\n    this.value = from;\n    this.unit = unit;\n  }\n  css(): string {\n    return roundTo(this.value, 2) + this.unit;\n  }\n  type(): ValueType {\n    return 'angle';\n  }\n  canonicalScalar(): number {\n    return asDegree(this);\n  }\n}\n\nexport interface MultiLength {\n  // Absolute canonical length\n  px?: number;\n\n  // Relative lengths\n  em?: number;\n  ex?: number;\n  ch?: number;\n  rem?: number;\n  vw?: number;\n  vh?: number;\n  vmin?: number;\n  vmax?: number;\n}\n\nexport class Length extends Value {\n  value: number | MultiLength;\n  unit: LengthUnit;\n  constructor(from: number | MultiLength, unit?: LengthUnit) {\n    super();\n    if (typeof from === 'number') {\n      this.value = from;\n      if (from === 0) {\n        this.unit = 'px';\n      } else {\n        this.unit = unit;\n      }\n    } else if (typeof unit === 'undefined') {\n      const nonZeroKeys: LengthUnit[] = Object.keys(from).filter(\n        (x) => typeof from[x] === 'number' && from[x] !== 0\n      ) as LengthUnit[];\n      if (nonZeroKeys.length === 0) {\n        // Everything's zero, return the canonical zero length: 0px\n        this.value = 0;\n        this.unit = 'px';\n      } else if (nonZeroKeys.length === 1) {\n        // A single non-zero unit? Return that unit.\n        this.value = from[nonZeroKeys[0]];\n        this.unit = nonZeroKeys[0];\n      } else {\n        this.value = from;\n        this.unit = 'multi';\n      }\n    } else {\n      // Force promotion to multi\n      this.value = from;\n      this.unit = 'multi';\n      console.assert(unit === 'multi');\n    }\n  }\n  css(): string {\n    if (typeof this.value === 'number') {\n      // If it's a number, display \"0\" and \"NaN\" without units\n      return this.value === 0 || isNaN(this.value)\n        ? Number(this.value).toString()\n        : roundTo(this.value, 2) + this.unit;\n    }\n\n    // It's a multi-unit length.\n\n    const result: MultiLength = {};\n    let units = Object.keys(this.value);\n\n    if (units.length > 1) {\n      // It's a multi-unit length, with multiple units\n      // Attempt to simplify it\n      let pxSum = 0;\n      units.forEach((x) => {\n        const inPx = asPx(this.value[x], x as LengthUnit);\n        if (!isNaN(inPx)) {\n          pxSum += inPx;\n        } else if (x !== 'px') {\n          result[x] = this.value[x];\n        }\n      });\n      if (pxSum !== 0) {\n        result['px'] = pxSum;\n      }\n    } else {\n      result[units[0]] = this.value[units[0]];\n    }\n\n    units = Object.keys(result);\n    if (units.length === 1) {\n      if (units[0] === 'px' && result['px'] === 0) {\n        return '0';\n      }\n      return roundTo(result[units[0]], 2) + units[0];\n    }\n\n    return (\n      'calc(' +\n      units.map((x) => Number(result[x]).toString() + x).join(' + ') +\n      ')'\n    );\n  }\n  type(): ValueType {\n    return 'length';\n  }\n  canonicalScalar(): number {\n    return this.unit === 'multi' ? NaN : asPx(this.value as number, this.unit);\n  }\n}\n\nexport class Time extends Value {\n  value: number;\n  unit: TimeUnit;\n  constructor(from: number, unit: TimeUnit) {\n    super();\n    this.value = from;\n    this.unit = unit;\n  }\n  css(): string {\n    return roundTo(this.value, 2) + this.unit;\n  }\n  type(): ValueType {\n    return 'time';\n  }\n  canonicalScalar(): number {\n    return this.unit === 'ms' ? this.value / 1000 : this.value;\n  }\n}\n\nexport class Frequency extends Value {\n  value: number;\n  unit: FrequencyUnit;\n  constructor(from: number, unit: FrequencyUnit) {\n    super();\n    this.value = from;\n    this.unit = unit;\n  }\n  css(): string {\n    return roundTo(this.value, 2) + this.unit;\n  }\n  type(): ValueType {\n    return 'frequency';\n  }\n  canonicalScalar(): number {\n    return this.unit === 'khz' ? this.value * 1000 : this.value;\n  }\n}\n\nexport class NumberValue extends Value {\n  value: number;\n  constructor(from: number) {\n    super();\n    this.value = from;\n  }\n  css(): string {\n    return Number(this.value).toString();\n  }\n  type(): ValueType {\n    return 'number';\n  }\n  canonicalScalar(): number {\n    return this.value;\n  }\n}\n\nexport class StringValue extends Value {\n  value: string;\n  constructor(from: string) {\n    super();\n    this.value = from;\n  }\n  css(quoteLiteral = ''): string {\n    return quoteLiteral + this.value + quoteLiteral;\n  }\n  type(): ValueType {\n    return 'string';\n  }\n  canonicalScalar(): number {\n    return parseFloat(this.value);\n  }\n  equals(v: Value): boolean {\n    return isString(v) && this.value === v.value;\n  }\n}\n\nexport class ArrayValue extends Value {\n  value: Value[];\n  constructor(from: Value[]) {\n    super();\n    this.value = from.map(makeValueFrom);\n  }\n  get(index: number): Value {\n    return this.value[index];\n  }\n  type(): ValueType {\n    return 'array';\n  }\n  css(): string {\n    return '[' + this.value.map((x) => x.css()).join(', ') + ']';\n  }\n  equals(v: Value): boolean {\n    return (\n      isArray(v) &&\n      this.value.length === v.value.length &&\n      this.value.every((val, idx) => val === v.value[idx])\n    );\n  }\n}\n\nexport function parseColorName(\n  name: string\n): { r: number; g: number; b: number; a: number } {\n  const color = colorName[name.toLowerCase()];\n  if (color) {\n    return {\n      r: color[0],\n      g: color[1],\n      b: color[2],\n      a: 1,\n    };\n  }\n\n  return undefined;\n}\n\nexport function parseHex(\n  hex: string\n): { r: number; g: number; b: number; a: number } {\n  if (!hex) return undefined;\n  if (hex[0] !== '#') return undefined;\n  hex = hex.slice(1);\n  let result;\n  if (hex.length <= 4) {\n    result = {\n      r: parseInt(hex[0] + hex[0], 16),\n      g: parseInt(hex[1] + hex[1], 16),\n      b: parseInt(hex[2] + hex[2], 16),\n    };\n    if (hex.length === 4) {\n      result.a = parseInt(hex[3] + hex[3], 16) / 255;\n    }\n  } else {\n    result = {\n      r: parseInt(hex[0] + hex[1], 16),\n      g: parseInt(hex[2] + hex[3], 16),\n      b: parseInt(hex[4] + hex[5], 16),\n    };\n    if (hex.length === 8) {\n      result.a = parseInt(hex[6] + hex[7], 16) / 255;\n    }\n  }\n  if (result && typeof result.a === 'undefined') result.a = 1.0;\n  return result;\n}\n\nfunction hueToRgbChannel(t1: number, t2: number, hue: number): number {\n  if (hue < 0) hue += 6;\n  if (hue >= 6) hue -= 6;\n\n  if (hue < 1) return (t2 - t1) * hue + t1;\n  else if (hue < 3) return t2;\n  else if (hue < 4) return (t2 - t1) * (4 - hue) + t1;\n  else return t1;\n}\n\nexport function hslToRgb(\n  hue: number,\n  sat: number,\n  light: number\n): { r: number; g: number; b: number } {\n  hue = ((hue + 360) % 360) / 60.0;\n  light = Math.max(0, Math.min(light, 1.0));\n  sat = Math.max(0, Math.min(sat, 1.0));\n  const t2 = light <= 0.5 ? light * (sat + 1) : light + sat - light * sat;\n  const t1 = light * 2 - t2;\n  return {\n    r: Math.round(255 * hueToRgbChannel(t1, t2, hue + 2)),\n    g: Math.round(255 * hueToRgbChannel(t1, t2, hue)),\n    b: Math.round(255 * hueToRgbChannel(t1, t2, hue - 2)),\n  };\n}\n\nexport function rgbToHsl(\n  r: number,\n  g: number,\n  b: number\n): { h: number; s: number; l: number } {\n  r = r / 255;\n  g = g / 255;\n  b = b / 255;\n  const min = Math.min(r, g, b);\n  const max = Math.max(r, g, b);\n\n  const delta = max - min;\n  let h: number;\n  let s: number;\n\n  if (max === min) {\n    h = 0;\n  } else if (r === max) {\n    h = (g - b) / delta;\n  } else if (g === max) {\n    h = 2 + (b - r) / delta;\n  } else if (b === max) {\n    h = 4 + (r - g) / delta;\n  }\n\n  h = Math.min(h * 60, 360);\n\n  if (h < 0) {\n    h += 360;\n  }\n\n  const l = (min + max) / 2;\n\n  if (max === min) {\n    s = 0;\n  } else if (l <= 0.5) {\n    s = delta / (max + min);\n  } else {\n    s = delta / (2 - max - min);\n  }\n\n  return { h: h, s: s, l: l };\n}\n\nexport interface ColorInterface {\n  r?: number /* [0..255] */;\n  g?: number /* [0..255] */;\n  b?: number /* [0..255] */;\n  h?: number /* [0..360]deg */;\n  s?: number;\n  l?: number;\n  a?: number /* [0..1] or [0..100]% */;\n}\n\nexport class Color extends Value implements ColorInterface {\n  r?: number; /* [0..255] */\n  g?: number; /* [0..255] */\n  b?: number; /* [0..255] */\n  h?: number; /* [0..360]deg */\n  s?: number;\n  l?: number;\n  a: number; /* [0..1] or [0..100]% */\n  constructor(from: ColorInterface | string) {\n    super();\n    if (typeof from === 'string') {\n      if (from.toLowerCase() === 'transparent') {\n        [this.r, this.g, this.b, this.a] = [0, 0, 0, 0];\n        [this.h, this.s, this.l] = [0, 0, 0];\n      } else {\n        const rgb = parseHex(from) || parseColorName(from);\n        if (!rgb) throw new Error();\n        Object.assign(this, rgb);\n        Object.assign(this, rgbToHsl(this.r, this.g, this.b));\n      }\n    } else {\n      Object.assign(this, from);\n      // Normalize the RGB/HSL values so that a color value\n      // always has r, g, b, h, s, l and a.\n      if (typeof this.r === 'number') {\n        // RGB data\n        Object.assign(this, rgbToHsl(this.r, this.g, this.b));\n      } else {\n        // HSL data\n        console.assert(typeof this.h === 'number');\n        this.h = (this.h + 360) % 360;\n        this.s = Math.max(0, Math.min(1.0, this.s));\n        this.l = Math.max(0, Math.min(1.0, this.l));\n        Object.assign(this, hslToRgb(this.h, this.s, this.l));\n      }\n    }\n    if (typeof this.a !== 'number') {\n      this.a = 1.0;\n    }\n  }\n  type(): ValueType {\n    return 'color';\n  }\n  opaque(): Color {\n    return new Color({ r: this.r, g: this.g, b: this.b });\n  }\n  luma(): number {\n    // Source: https://www.w3.org/TR/WCAG20/#relativeluminancedef\n    let r = this.r / 255.0;\n    let g = this.g / 255.0;\n    let b = this.b / 255.0;\n    r = r <= 0.03928 ? r / 12.92 : Math.pow((r + 0.055) / 1.055, 2.4);\n    g = g <= 0.03928 ? g / 12.92 : Math.pow((g + 0.055) / 1.055, 2.4);\n    b = b <= 0.03928 ? b / 12.92 : Math.pow((b + 0.055) / 1.055, 2.4);\n\n    return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n  }\n  hex(): string {\n    let hexString = (\n      (1 << 24) +\n      (clampByte(this.r) << 16) +\n      (clampByte(this.g) << 8) +\n      clampByte(this.b)\n    )\n      .toString(16)\n      .slice(1);\n\n    if (this.a < 1.0) {\n      hexString += ('00' + Math.round(this.a * 255).toString(16)).slice(-2);\n    }\n\n    // Compress hex from hex-6 or hex-8 to hex-3 or hex-4 if possible\n    if (\n      hexString[0] === hexString[1] &&\n      hexString[2] === hexString[3] &&\n      hexString[4] === hexString[5] &&\n      hexString[6] === hexString[7]\n    ) {\n      hexString =\n        hexString[0] +\n        hexString[2] +\n        hexString[4] +\n        (this.a < 1.0 ? hexString[6] : '');\n    }\n\n    return '#' + hexString;\n  }\n  rgb(): string {\n    return `rgb(${roundTo(this.r, 2)}, ${roundTo(this.g, 2)}, ${roundTo(\n      this.b,\n      2\n    )}${this.a < 1.0 ? ', ' + roundTo(100 * this.a, 2) + '%' : ''})`;\n  }\n  hsl(): string {\n    return `hsl(${this.h}deg, ${this.s}%, ${this.l}%, ${\n      this.a < 1.0 ? ', ' + roundTo(100 * this.a, 2) + '%' : ''\n    })`;\n  }\n  css(): string {\n    if (this.r === 0 && this.g === 0 && this.b === 0 && this.a === 0)\n      return 'transparent';\n    if (this.a < 1) {\n      return this.rgb();\n    }\n    return this.hex();\n  }\n  canonicalScalar(): number {\n    return this.luma();\n  }\n  equals(v: Value): boolean {\n    return (\n      isColor(v) &&\n      this.r === v.r &&\n      this.g === v.g &&\n      this.b === v.b &&\n      this.a === v.a\n    );\n  }\n}\n\nexport function makeValueFrom(from: {\n  type: () => ValueType;\n  [key: string]: unknown;\n}): Value {\n  switch (from.type()) {\n    case 'color':\n      return new Color(from as ColorInterface);\n    case 'frequency':\n      return new Frequency(from.value as number, from.unit as FrequencyUnit);\n    case 'time':\n      return new Time(from.value as number, from.unit as TimeUnit);\n    case 'angle':\n      return new Angle(from.value as number, from.unit as AngleUnit);\n    case 'string':\n      return new StringValue(from.value as string);\n    case 'length':\n      return new Length(from.value, from.unit as LengthUnit);\n    case 'percentage':\n      return new Percentage(from.value as number);\n    case 'number':\n      return new NumberValue(from.value as number);\n    case 'array':\n      return new ArrayValue((from.value as unknown[]).map(makeValueFrom));\n    default:\n      console.error('Unknown value type');\n  }\n  return undefined;\n}\nexport function isColor(arg: Value): arg is Color {\n  return arg instanceof Color;\n}\n\n/**\n * Convert a value to a color object.\n *\n * @param {object|string} value - hex string, color name or object with partial\n *\n */\n\nexport function asColor(value: Record<string, unknown> | string): Color {\n  if (!value) return undefined;\n  let result: Color;\n  try {\n    result = new Color(value);\n  } catch (_err) {\n    result = undefined;\n  }\n  return result;\n}\n\nexport function isColorArray(arg: Value): arg is ArrayValue {\n  return arg instanceof ArrayValue && arg.value.every((x) => isColor(x));\n}\n\nexport function isNumber(arg: Value): arg is NumberValue {\n  return arg instanceof NumberValue;\n}\n\nexport function assertNumber(arg: Value): asserts arg is NumberValue {\n  console.assert(arg instanceof NumberValue);\n}\n\nfunction assertNumberOrPercentage(arg: Value): asserts arg is NumberValue {\n  console.assert(arg instanceof NumberValue || arg instanceof Percentage);\n}\n\nexport function assertLength(arg: Value): asserts arg is Length {\n  console.assert(arg instanceof Length);\n}\n\nexport function isPercentage(arg: Value): arg is Percentage {\n  return arg instanceof Percentage;\n}\n\nexport function isLength(arg: Value): arg is Length {\n  return arg instanceof Length;\n}\n\nexport function isString(arg: Value): arg is StringValue {\n  return arg instanceof StringValue;\n}\n\nexport function isAngle(arg: Value): arg is Angle {\n  return arg instanceof Angle;\n}\n\nexport function isTime(arg: Value): arg is Time {\n  return arg instanceof Time;\n}\n\nexport function isFrequency(arg: Value): arg is Frequency {\n  return arg instanceof Frequency;\n}\n\nexport function isArray(arg: Value): arg is ArrayValue {\n  return arg instanceof ArrayValue;\n}\n\nexport function isZero(arg: Value): arg is NumberValue {\n  return arg instanceof NumberValue && arg.value === 0;\n}\n\nexport function asInteger(value: Value, defaultValue?: number): number {\n  if (isNumber(value)) {\n    return Math.round(value.value);\n  }\n  if (typeof defaultValue === 'undefined') assertNumber(value);\n  return defaultValue;\n}\n\nexport function asDecimalRatio(\n  value: Value,\n  defaultValue?: number | null\n): number {\n  if (isPercentage(value)) {\n    return value.value / 100;\n  } else if (isNumber(value)) {\n    return value.value;\n  }\n\n  if (typeof defaultValue === 'undefined') assertNumberOrPercentage(value);\n  return defaultValue;\n}\n\nexport function asDegree(value: Value): number {\n  // https://drafts.csswg.org/css-values-3/#angle-value\n\n  if (isAngle(value)) {\n    if (value.unit === 'deg') {\n      return value.value;\n    } else if (value.unit === 'rad') {\n      return (value.value * 180) / Math.PI;\n    } else if (value.unit === 'grad') {\n      return (value.value * 180) / 200;\n    } else if (value.unit === 'turn') {\n      return value.value * 360.0;\n    }\n    throwError(ErrorCode.UnknownUnit, value.unit);\n  } else {\n    assertNumber(value);\n    // Degree is the canonical unit for angles\n    return value.value;\n  }\n}\n\nfunction asPx(\n  value: number | MultiLength,\n  unit: LengthUnit,\n  baseUnits?: BaseLengthUnits\n): number {\n  // See https://drafts.csswg.org/css-values-3/#lengths\n  if (typeof value !== 'number') {\n    console.assert(unit === 'multi');\n    let pxSum = value['px'] ?? 0;\n    Object.keys(value).forEach((x) => {\n      const inPx = asPx(this.value[x], x as LengthUnit, baseUnits);\n      if (isNaN(inPx)) return NaN;\n      pxSum += pxSum;\n    });\n    return pxSum;\n  }\n  if (unit === 'px') {\n    return value;\n  } else if (unit === 'cm') {\n    return (value * 96.0) / 2.54;\n  } else if (unit === 'mm') {\n    return (value * 96.0) / 25.4;\n  } else if (unit === 'Q') {\n    return (value * 96.0) / 2.54 / 40.0;\n  } else if (unit === 'in') {\n    return value * 96.0;\n  } else if (unit === 'pc') {\n    return value * 16.0;\n  } else if (unit === 'pt') {\n    return (value * 96.0) / 72.0;\n  }\n  let base: number;\n  if (unit === 'vmin') {\n    base = Math.min(baseUnits?.vh ?? NaN, baseUnits?.vw ?? NaN);\n  } else if (unit === 'vmax') {\n    base = Math.max(baseUnits?.vh ?? NaN, baseUnits?.vw ?? NaN);\n  } else {\n    base = baseUnits?.[unit] ?? NaN;\n  }\n\n  return base * value;\n}\n\nexport function asPercent(value: Value): number {\n  if (isPercentage(value)) {\n    return value.value / 100;\n  }\n  assertNumber(value);\n  return value.value;\n}\n\nexport function asString(value: Value, defaultValue: string): string {\n  if (!isString(value)) {\n    return defaultValue;\n  }\n  return value.value;\n}\n\nexport function compareValue(a: Value, b: Value): number {\n  // @todo: compare strings (asCanonicalString())\n  return b.canonicalScalar() - a.canonicalScalar();\n}\n\nexport function promoteToMulti(value: Length | NumberValue): Length {\n  if (isNumber(value)) {\n    return new Length({ px: value.value }, 'multi');\n  }\n  if (value.unit === 'multi') return value;\n\n  const newValue: MultiLength = {};\n  newValue[value.unit] = value.value;\n\n  return new Length(newValue, 'multi');\n}\n\nexport function scaleLength(arg1: Length, arg2?: Value): ArrayValue {\n  if (arg1.unit === 'multi') {\n    throw new SyntaxError(ErrorCode.InvalidOperand);\n  }\n  const scaleName = asString(arg2, 'pentatonic').toLowerCase();\n  let scale = {\n    'tritonic': [2, 3],\n    'tetratonic': [2, 4],\n    'pentatonic': [2, 5],\n    'golden': [1.618, 1],\n    'golden ditonic': [1.618, 2],\n  }[scaleName];\n  if (typeof scale === 'undefined') {\n    // Try to parse the scale as \"p:q\"\n    scale = scaleName.split(':').map((x) => parseFloat(x));\n    if (isNaN(scale[0]) || isNaN(scale[1])) {\n      throw new SyntaxError(ErrorCode.InvalidOperand);\n    }\n    scale = [scale[1] / scale[0], 1];\n  }\n  const [r, n] = scale;\n  const range =\n    (arg1.value as number) * (Math.pow(r, 7 / n) - Math.pow(r, -2 / n));\n  const precision =\n    range < 10 || (arg1.value as number) * Math.pow(r, -2 / n) < 1 ? 2 : 0;\n  const result: Value[] = [-2, -1, 0, 1, 2, 3, 4, 5, 6, 7].map(\n    (i: number): Value =>\n      new Length(\n        roundTo((arg1.value as number) * Math.pow(r, i / n), precision),\n        arg1.unit\n      )\n  );\n\n  return new ArrayValue(result);\n}\n","const chalk = require('chalk');\nconst ciInfo = require('ci-info');\n\n//\n// Terminal colors for various kind of messages\n//\nconst tcOrange = '#ffcc00';\nconst tcRed = '#fa2040';\nconst tcBlue = '#6ab3ff';\nconst tcPurple = '#d1d7ff';\n\n/** Do not use fancy color output if the output stream is not a terminal\n * (e.g. if we're redirecting errors to a log file) or when in a CI environment.\n * Note that the debug console in VSCode returns 'undefined' for isTTY.\n */\nlet gUseColor = (process.stdout.isTTY ?? false) && !ciInfo.isCI;\n\nexport const terminal = {\n  useColor: (flag: boolean): void => {\n    gUseColor = flag;\n  },\n  autoFormat: (m: string): string => {\n    return m\n      .replace(/(\"(.*)\")/g, (x) => {\n        return terminal.string(x.slice(1, -1));\n      })\n      .replace(/(`(.*)`)/g, (x) => {\n        return terminal.keyword(x);\n      });\n  },\n  success: (m = ''): string => {\n    chalk.green('✔︎   ' + m);\n    return gUseColor ? chalk.bold.green('✔︎   ' + m) : '✔︎   ' + m;\n  },\n  error: (m = ''): string => {\n    return gUseColor ? chalk.hex(tcRed)(chalk.bold('✘   ' + m)) : '✘   ' + m;\n  },\n  warning: (m = ''): string => {\n    return gUseColor\n      ? chalk.hex(tcOrange)(chalk.bold('⚠️   ' + m))\n      : '⚠   ' + m;\n  },\n  path: (m = ''): string => {\n    return gUseColor ? chalk.hex(tcBlue).italic(m) : m;\n  },\n  keyword: (m = ''): string => {\n    return gUseColor ? chalk.hex(tcOrange)(m) : m;\n  },\n  string: (m = ''): string => {\n    return gUseColor\n      ? chalk.hex(tcOrange)('\"' + chalk.italic(m) + '\"')\n      : '\"' + m + '\"';\n  },\n  dim: (m = ''): string => {\n    return gUseColor ? chalk.hex('#999')(m) : m;\n  },\n  time: (t = new Date()): string => {\n    return gUseColor\n      ? chalk.hex(tcPurple)(`[${t.toLocaleTimeString()}]`)\n      : '[' + t + ']';\n  },\n  link: (m: string): string => {\n    return gUseColor\n      ? '\\n▷   ' +\n          chalk.hex(tcPurple)(\n            'https://github.com/arnog/chromatic/docs/errors/' + m + '.md'\n          )\n      : '\\n▷   https://github.com/arnog/chromatic/docs/errors/' + m + '.md';\n  },\n};\n","const chroma = require('chroma-js');\nimport {\n  NumberValue,\n  Color,\n  StringValue,\n  Value,\n  clampByte,\n  ArrayValue,\n  isAngle,\n  isNumber,\n  isPercentage,\n  assertNumber,\n  asDecimalRatio,\n  asColor,\n  asDegree,\n  asInteger,\n  asPercent,\n  asString,\n  hslToRgb,\n} from './value';\nimport { getSuggestion } from './utils';\nimport { throwError, ErrorCode } from './errors';\n\nfunction clampUnit(x: number): number {\n  return x < 0 ? 0 : x > 1 ? 1 : x;\n}\n\nfunction asDecimalByte(value: Value): number {\n  if (isPercentage(value)) {\n    return Math.round((255 * value.value) / 100);\n  }\n  assertNumber(value);\n  return Math.round(value.value);\n}\n\n/**\n * L: 0..100\n * a: -128..128\n * b: -128..128\n */\n\nfunction labToRgb(\n  L: number,\n  aStar: number,\n  bStar: number\n): { r: number; g: number; b: number } {\n  L = Math.max(0, Math.min(100, L));\n  aStar = Math.max(-128, Math.min(128, aStar));\n  bStar = Math.max(-128, Math.min(128, bStar));\n  let y = (L + 16) / 116;\n  let x = aStar / 500 + y;\n  let z = y - bStar / 200;\n\n  x = 0.95047 * (x * x * x > 0.008856 ? x * x * x : (x - 16 / 116) / 7.787);\n  y = 1.0 * (y * y * y > 0.008856 ? y * y * y : (y - 16 / 116) / 7.787);\n  z = 1.08883 * (z * z * z > 0.008856 ? z * z * z : (z - 16 / 116) / 7.787);\n\n  let r = x * 3.2406 + y * -1.5372 + z * -0.4986;\n  let g = x * -0.9689 + y * 1.8758 + z * 0.0415;\n  let b = x * 0.0557 + y * -0.204 + z * 1.057;\n\n  r = r > 0.0031308 ? 1.055 * Math.pow(r, 1 / 2.4) - 0.055 : 12.92 * r;\n  g = g > 0.0031308 ? 1.055 * Math.pow(g, 1 / 2.4) - 0.055 : 12.92 * g;\n  b = b > 0.0031308 ? 1.055 * Math.pow(b, 1 / 2.4) - 0.055 : 12.92 * b;\n\n  return {\n    r: clampByte(r * 255),\n    g: clampByte(g * 255),\n    b: clampByte(b * 255),\n  };\n}\n\n/**\n * r: 0..255\n * g: 0..255\n * b: 0..255\n * L: 0..100\n * a: -128..128\n * b: -128..128\n */\nfunction rgbToLab(\n  r: number,\n  g: number,\n  b: number\n): { L: number; a: number; b: number } {\n  r = clampByte(r) / 255;\n  g = clampByte(g) / 255;\n  b = clampByte(b) / 255;\n\n  r = r > 0.04045 ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92;\n  g = g > 0.04045 ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92;\n  b = b > 0.04045 ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92;\n\n  let x = (r * 0.4124 + g * 0.3576 + b * 0.1805) / 0.95047;\n  let y = (r * 0.2126 + g * 0.7152 + b * 0.0722) / 1.0;\n  let z = (r * 0.0193 + g * 0.1192 + b * 0.9505) / 1.08883;\n\n  x = x > 0.008856 ? Math.pow(x, 1 / 3) : 7.787 * x + 16 / 116;\n  y = y > 0.008856 ? Math.pow(y, 1 / 3) : 7.787 * y + 16 / 116;\n  z = z > 0.008856 ? Math.pow(z, 1 / 3) : 7.787 * z + 16 / 116;\n\n  return { L: 116 * y - 16, a: 500 * (x - y), b: 200 * (y - z) };\n}\n\nfunction rgbToXyz(\n  r: number,\n  g: number,\n  b: number\n): { x: number; y: number; z: number } {\n  return {\n    x: 0.430574 * r + 0.34155 * g + 0.178325 * b,\n    y: 0.222015 * r + 0.706655 * g + 0.07133 * b,\n    z: 0.020183 * r + 0.129553 * g + 0.93918 * b,\n  };\n}\n\nfunction xyzToRgb(\n  x: number,\n  y: number,\n  z: number\n): { r: number; g: number; b: number } {\n  return {\n    r: 3.063218 * x - 1.393325 * y - 0.475802 * z,\n    g: -0.969243 * x + 1.875966 * y + 0.041555 * z,\n    b: 0.067871 * x - 0.228834 * y + 1.069251 * z,\n  };\n}\n\nconst colorDeficiencyTable = {\n  protanopia: { cpu: 0.735, cpv: 0.265, am: 1.273463, ayi: -0.073894 },\n  deuteranopia: { cpu: 1.14, cpv: -0.14, am: 0.968437, ayi: 0.003331 },\n  tritanopia: { cpu: 0.171, cpv: -0.003, am: 0.062921, ayi: 0.292119 },\n};\n\nfunction hwbToRgb(\n  hue: number,\n  white: number,\n  black: number\n): { r: number; g: number; b: number } {\n  const rgb = hslToRgb(hue, 1, 0.5);\n  const xs = [];\n  xs[0] = rgb.r / 255;\n  xs[1] = rgb.g / 255;\n  xs[2] = rgb.b / 255;\n  const total = white + black;\n  if (total > 1) {\n    white = Number((white / total).toFixed(2));\n    black = Number((black / total).toFixed(2));\n  }\n  for (let i = 0; i < 3; i++) {\n    xs[i] *= 1 - white - black;\n    xs[i] += white;\n    xs[i] = Number(xs[i] * 255);\n  }\n  return { r: xs[0], g: xs[1], b: xs[2] };\n}\n\nconst whiteColor = new Color('#fff');\nconst blackColor = new Color('#000');\n\nfunction mixColor(c1: Value, c2: Value, weight: Value, model?: Value): Color {\n  // @todo: support additional color models. See color-convert npm module.\n  const modelName = asString(model, 'hsl').toLowerCase();\n  const color1 = asColor(c1);\n  if (!color1) return undefined;\n  const color2 = asColor(c2);\n  if (!color2) return color1;\n\n  const w = asDecimalRatio(weight, 0.5);\n\n  let alpha = typeof color2.a === 'number' ? color2.a : 1.0;\n  alpha = alpha + ((typeof color1.a === 'number' ? color2.a : 1.0) - alpha) * w;\n  if (modelName === 'rgb') {\n    return new Color({\n      r: color1.r + (color2.r - color1.r) * w,\n      g: color1.g + (color2.g - color1.g) * w,\n      b: color1.b + (color2.b - color1.b) * w,\n      a: alpha,\n    });\n  } else if (modelName === 'hsl') {\n    return new Color({\n      h: color1.h + (color2.h - color1.h) * w,\n      s: color1.s + (color2.s - color1.s) * w,\n      l: color1.l + (color2.l - color1.l) * w,\n      a: alpha,\n    });\n  }\n}\n\nfunction getHPrimeFn(x, y): number {\n  if (x === 0 && y === 0) return 0;\n  const hueAngle = (Math.atan2(x, y) * 180) / Math.PI;\n  return hueAngle >= 0 ? hueAngle : hueAngle + 360;\n}\n\n/**\n * Measure the distance between two colors.\n * Colors that have a deltaE of less than 2 are difficult to distinguish.\n *\n *  Uses the CIE-2000 algorithm which correct for perceptual uniformity.\n *  http://en.wikipedia.org/wiki/Color_difference#CIEDE2000\n *  http://www2.ece.rochester.edu/~gsharma/ciede2000/ciede2000noteCRNA.pdf\n */\n\nexport function getDeltaE(c1: Color, c2: Color): number {\n  const kSubL = 1;\n  const kSubC = 1;\n  const kSubH = 1;\n\n  const x1 = rgbToLab(c1.r, c1.g, c1.b);\n  const x2 = rgbToLab(c2.r, c2.g, c2.b);\n\n  const deltaLPrime = x2.L - x1.L;\n  const LBar = (x1.L + x2.L) / 2;\n\n  const C1 = Math.sqrt(x1.a * x1.a + x1.b * x1.b);\n  const C2 = Math.sqrt(x2.a * x2.a + x2.b * x2.b);\n  const CBar = (C1 + C2) / 2;\n\n  const aPrime =\n    1 - Math.sqrt(Math.pow(CBar, 7) / (Math.pow(CBar, 7) + Math.pow(25, 7)));\n  const aPrime1 = x1.a + (x1.a / 2) * aPrime;\n  const aPrime2 = x2.a + (x2.a / 2) * aPrime;\n\n  const CPrime1 = Math.sqrt(aPrime1 * aPrime1 + x1.b * x1.b);\n  const CPrime2 = Math.sqrt(aPrime2 * aPrime2 + x2.b * x2.b);\n  const CBarPrime = (CPrime1 + CPrime2) / 2;\n  const deltaCPrime = CPrime2 - CPrime1;\n  const LBarPrime = Math.pow(LBar - 50, 2);\n  const S_L = 1 + (0.015 * LBarPrime) / Math.sqrt(20 + LBarPrime);\n  const S_C = 1 + 0.045 * CBarPrime;\n\n  const hPrime1 = getHPrimeFn(x1.b, aPrime1);\n  const hPrime2 = getHPrimeFn(x2.b, aPrime2);\n\n  const deltahPrime =\n    C1 === 0 || C2 === 0\n      ? 0\n      : Math.abs(hPrime1 - hPrime2) <= 180\n      ? hPrime2 - hPrime1\n      : hPrime2 <= hPrime1\n      ? hPrime2 - hPrime1 + 360\n      : hPrime2 - hPrime1 - 360;\n  const deltaHPrime =\n    2 *\n    Math.sqrt(CPrime1 * CPrime2) *\n    Math.sin((deltahPrime * Math.PI) / 180 / 2);\n  const HBarPrime =\n    Math.abs(hPrime1 - hPrime2) > 180\n      ? (hPrime1 + hPrime2 + 360) / 2\n      : (hPrime1 + hPrime2) / 2;\n  const T =\n    1 -\n    0.17 * Math.cos((Math.PI / 180) * (HBarPrime - 30)) +\n    0.24 * Math.cos((Math.PI / 180) * (2 * HBarPrime)) +\n    0.32 * Math.cos((Math.PI / 180) * (3 * HBarPrime + 6)) -\n    0.2 * Math.cos((Math.PI / 180) * (4 * HBarPrime - 63));\n  const S_H = 1 + 0.015 * CBarPrime * T;\n  const R_T =\n    -2 *\n    Math.sqrt(\n      Math.pow(CBarPrime, 7) / (Math.pow(CBarPrime, 7) + Math.pow(25, 7))\n    ) *\n    Math.sin(\n      (Math.PI / 180) * (60 * Math.exp(-Math.pow((HBarPrime - 275) / 25, 2)))\n    );\n  const lightness = deltaLPrime / (kSubL * S_L);\n  const chroma = deltaCPrime / (kSubC * S_C);\n  const hue = deltaHPrime / (kSubH * S_H);\n\n  return Math.sqrt(\n    lightness * lightness + chroma * chroma + hue * hue + R_T * chroma * hue\n  );\n}\n\nexport function filterColor(c: Color, filter: string): Color {\n  // https://ixora.io/projects/colorblindness/color-blindness-simulation-research/\n  // https://github.com/hx2A/ColorBlindness/blob/master/src/colorblind/ColorUtilities.java\n  switch (filter) {\n    case 'none':\n      return c;\n\n    case 'grayscale':\n      const lab = rgbToLab(c.r, c.g, c.b);\n      return new Color({\n        a: c.a,\n        ...labToRgb(lab.L, 0, 0),\n      });\n\n    case 'protanopia':\n    case 'deuteranopia':\n    case 'tritanopia': {\n      const gamma = 2.2;\n      // (x, y, z) in [0..1]^3\n      const { x, y, z } = rgbToXyz(\n        Math.pow(c.r / 255, gamma),\n        Math.pow(c.g / 255, gamma),\n        Math.pow(c.b / 255, gamma)\n      );\n      const u = x + y + z != 0 ? x / (x + y + z) : 0;\n      const v = x + y + z != 0 ? y / (x + y + z) : 0;\n      const nx = (y * 0.312713) / 0.329016;\n      const nz = (y * 0.358271) / 0.329016;\n\n      let clm: number;\n      if (u < colorDeficiencyTable[filter].cpu) {\n        clm =\n          (colorDeficiencyTable[filter].cpv - v) /\n          (colorDeficiencyTable[filter].cpu - u);\n      } else {\n        clm =\n          (v - colorDeficiencyTable[filter].cpv) /\n          (u - colorDeficiencyTable[filter].cpu);\n      }\n      const clyi = v - u * clm;\n      const dU =\n        (colorDeficiencyTable[filter].ayi - clyi) /\n        (clm - colorDeficiencyTable[filter].am);\n      const dV = clm * dU + clyi;\n\n      const xPrime = (dU * y) / dV;\n      const zPrime = ((1 - (dU + dV)) * y) / dV;\n\n      const dX = nx - xPrime;\n      const dZ = nz - zPrime;\n      const { r: dr, g: dg, b: db } = xyzToRgb(dX, 0, dZ);\n      let { r: rPrime, g: gPrime, b: bPrime } = xyzToRgb(xPrime, y, zPrime);\n      const deltaR = rPrime ? ((rPrime < 0 ? 0 : 1) - rPrime) / dr : 0;\n      const deltaG = gPrime ? ((gPrime < 0 ? 0 : 1) - gPrime) / dg : 0;\n      const deltaB = bPrime ? ((bPrime < 0 ? 0 : 1) - bPrime) / db : 0;\n\n      const adjustment = Math.max(\n        deltaR > 1 || deltaR < 0 ? 0 : deltaR,\n        deltaG > 1 || deltaG < 0 ? 0 : deltaG,\n        deltaB > 1 || deltaB < 0 ? 0 : deltaB\n      );\n      rPrime += adjustment * dr;\n      gPrime += adjustment * dg;\n      bPrime += adjustment * db;\n      return new Color({\n        r: 255 * Math.pow(clampUnit(rPrime), 1 / gamma),\n        g: 255 * Math.pow(clampUnit(gPrime), 1 / gamma),\n        b: 255 * Math.pow(clampUnit(bPrime), 1 / gamma),\n      });\n    }\n  }\n  return undefined;\n}\n\nexport function getSimilarColors(\n  target: Color,\n  colors: { name: string; color: Color }[],\n  filter?: string\n): { name: string; color: Color; deltaE: number }[] {\n  const result = [];\n\n  const filteredTarget = filterColor(target, filter);\n\n  colors.forEach((x) => {\n    if (!target.equals(x.color)) {\n      // Use an increased threshold (6) when applying a filter.\n      // Seems to produce more accurate results for\n      // confusing colors for color deficient people.\n      const diff = filter\n        ? getDeltaE(filteredTarget, filterColor(x.color, filter)) / 3\n        : getDeltaE(target, x.color);\n      if (diff < 2) {\n        result.push({\n          name: x.name,\n          color: x.color,\n          deltaE: diff,\n        });\n      }\n    }\n  });\n  return result.length === 0\n    ? null\n    : result.sort((a, b) => a.deltaE - b.deltaE);\n}\n\nexport function scaleColor(\n  arg1: Color,\n  arg2?: Value,\n  arg3?: Value,\n  arg4?: Value\n): ArrayValue {\n  // For an analysis of various ramps, see https://uxplanet.org/designing-systematic-colors-b5d2605b15c\n  let c1 = new Color('#fff');\n  let c2: Color;\n  let c3 = new Color('#000');\n  let n = 10;\n  if (arg3?.type() === 'color') {\n    // If a single color is provided, we'll calculate a color ramp\n    // with the provided color as the midpoint, and black and white\n    // as the extremes.\n    c1 = asColor(arg1);\n    c2 = asColor(arg2);\n    c3 = asColor(arg3);\n    n = asInteger(arg4, 10);\n  } else if (arg2?.type() === 'color') {\n    c1 = asColor(arg1);\n    c2 = asColor(arg2);\n    c3 = asColor(arg2);\n    n = asInteger(arg3, 10);\n  } else if (arg1.type() === 'color') {\n    c2 = asColor(arg1);\n    c3 = new Color({\n      // Correct the hue for the Abney Effect\n      // See https://royalsocietypublishing.org/doi/pdf/10.1098/rspa.1909.0085\n      // (the human vision system perceives a hue shift as colors\n      // change in colorimetric purity (mix with black or mix\n      // with white))\n      // and the Bezold-Brücke effect (hue shift as intensity increases)\n      // See https://www.sciencedirect.com/science/article/pii/S0042698999000851\n\n      // h: c2.h >= 60 && c2.h <= 240 ? c2.h + 30 : c2.h - 30,\n      h: c2.h - 20 * Math.sin(4 * Math.PI * (c2.h / 360)),\n      s: c2.s + 0.2 * Math.sin(2 * Math.PI * (c2.h / 360)),\n      l:\n        c2.h >= 180\n          ? c2.l - 0.35\n          : c2.l - 0.2 + 0.1 * Math.sin(4 * Math.PI * (c2.h / 360)),\n    });\n    n = asInteger(arg2, 10);\n    const mode = new StringValue('rgb');\n    return new ArrayValue([\n      mixColor(c1, c2, new NumberValue(0.12), mode),\n      mixColor(c1, c2, new NumberValue(0.3), mode),\n      mixColor(c1, c2, new NumberValue(0.5), mode),\n      mixColor(c1, c2, new NumberValue(0.7), mode),\n      mixColor(c1, c2, new NumberValue(0.85), mode),\n      c2,\n      mixColor(c3, c2, new NumberValue(0.85), mode),\n      mixColor(c3, c2, new NumberValue(0.7), mode),\n      mixColor(c3, c2, new NumberValue(0.5), mode),\n      mixColor(c3, c2, new NumberValue(0.2), mode),\n      // FUNCTIONS.darken(c2, new NumberValue(0.06), mode),\n      // FUNCTIONS.darken(c2, new NumberValue(0.12), mode),\n      // FUNCTIONS.darken(c2, new NumberValue(0.18), mode),\n      // FUNCTIONS.darken(c2, new NumberValue(0.24), mode),\n    ]);\n  }\n\n  if (!c1 || !c2 || !c3) return undefined;\n\n  // If there are three colors provided, we calculate a scale\n  // in Lab mode, corrected for lightness (so that there is as many\n  // light and dark colors). As a result, the mid-point may be a\n  // color than c2.\n  // This kind of scale is most appropriate for data visualization.\n  const colors = chroma\n    .scale(\n      // chroma.bezier([\n      //     c1.opaque().hex(),\n      //     c2.opaque().hex(),\n      //     c3.opaque().hex(),\n      // ])\n      [c1.opaque().hex(), c2.opaque().hex(), c3.opaque().hex()]\n    )\n    .mode('lab')\n    .correctLightness()\n    .colors(n + 1);\n\n  return new ArrayValue(colors.map((x) => new Color(x)));\n}\n\n/* Functions that take a \"color\" argument list */\n/* Which includes either space or comma as a separator, and \"/\" for alpha */\nexport const COLOR_ARGUMENTS_FUNCTIONS = [\n  'rgb',\n  'rgba',\n  'hsl',\n  'hsla',\n  'hwb',\n  'gray',\n  'lab',\n];\n\nexport const COLOR_FUNCTION_ARGUMENTS = {\n  rgb:\n    'number|percentage, number|percentage, number|percentage,number|percentage|none',\n  rgba:\n    'number|percentage, number|percentage, number|percentage,number|percentage|none',\n  hsl:\n    'number|angle, number|percentage, number|percentage, number|percentage|none',\n  hsla:\n    'number|angle, number|percentage, number|percentage, number|percentage|none',\n  hsv:\n    'number|angle, number|percentage, number|percentage, number|percentage|none',\n  hwb:\n    'number|angle, number|percentage, number|percentage, number|percentage|none',\n  lab: 'number|percentage, number, number, number|percentage|none',\n  gray: 'number|percentage, number|percentage|none',\n  mix: 'color, color, number|percentage|none, string|none',\n  saturate: 'color, number|percentage|none',\n  desaturate: 'color, number|percentage|none',\n  lighten: 'color, number|percentage|none',\n  darken: 'color, number|percentage|none',\n  rotateHue: 'color, angle|number|none',\n  complement: 'color',\n  contrast: 'color, color|none, color|none',\n  filter: 'color, string',\n\n  tint: 'color, number|percentage|none',\n  shade: 'color, number|percentage|none',\n};\n\nexport const COLOR_FUNCTIONS = {\n  /** r, g, b: a value as a number in [0...255] or as a percentage. a: a number in [0...1] or a percentage */\n  rgb: (r: Value, g: Value, b: Value, a?: Value): Color =>\n    new Color({\n      r: asDecimalByte(r),\n      g: asDecimalByte(g),\n      b: asDecimalByte(b),\n      a: asDecimalRatio(a, 1.0),\n    }),\n  hsl: (h: Value, s: Value, l: Value, a?: Value): Color =>\n    new Color({\n      h: asDegree(h),\n      s: asPercent(s),\n      l: asPercent(l),\n      a: asDecimalRatio(a, 1.0),\n    }),\n  hsv: (h: Value, sat: Value, val: Value, a?: Value): Color => {\n    let s = asPercent(sat);\n    const v = asPercent(val);\n\n    const l = ((2 - s) * v) / 2;\n\n    if (l != 0) {\n      if (l == 1) {\n        s = 0;\n      } else if (l < 0.5) {\n        s = (s * v) / (l * 2);\n      } else {\n        s = (s * v) / (2 - l * 2);\n      }\n    }\n    return new Color({\n      h: asDegree(h),\n      s: s,\n      l: l,\n      a: asDecimalRatio(a, 1.0),\n    });\n  },\n  hwb: (h: Value, w: Value, b: Value, a?: Value): Color => {\n    return new Color({\n      a: asDecimalRatio(a, 1.0),\n      ...hwbToRgb(asDegree(h), asPercent(w), asPercent(b)),\n    });\n  },\n  lab: (l: Value, a: Value, b: Value, alpha?: Value): Color => {\n    return new Color({\n      a: asDecimalRatio(alpha, 1.0),\n      ...labToRgb(100 * asPercent(l), asDecimalRatio(a), asDecimalRatio(b)),\n    });\n  },\n  gray: (g: Value, alpha: Value): Color => {\n    return new Color({\n      a: asDecimalRatio(alpha, 1.0),\n      ...labToRgb(100 * asPercent(g), 0, 0),\n    });\n  },\n  filter: (c: Color, filterValue: StringValue): Color => {\n    const filterName = asString(filterValue, 'none').toLowerCase();\n    const result = filterColor(c, asString(filterValue, 'none').toLowerCase());\n    if (!result) {\n      throwError(\n        ErrorCode.InvalidArgument,\n        'filter()',\n        `\"${filterName}\"`,\n        getSuggestion(filterName, [\n          'none',\n          'grayscale',\n          'protanopia',\n          'deuteranopia',\n          'tritanopia',\n        ])\n      );\n    }\n\n    return result;\n  },\n  mix: (c1: Value, c2: Value, weight: Value, model?: Value): Color => {\n    // @todo: support additional color models. See color-convert npm module.\n    const modelName = asString(model, 'hsl').toLowerCase();\n    const color1 = asColor(c1);\n    if (!color1) return undefined;\n    const color2 = asColor(c2);\n    if (!color2) return color1;\n\n    const w = asDecimalRatio(weight, 0.5);\n\n    let alpha = typeof color2.a === 'number' ? color2.a : 1.0;\n    alpha =\n      alpha + ((typeof color1.a === 'number' ? color2.a : 1.0) - alpha) * w;\n    if (modelName === 'rgb') {\n      return new Color({\n        r: color1.r + (color2.r - color1.r) * w,\n        g: color1.g + (color2.g - color1.g) * w,\n        b: color1.b + (color2.b - color1.b) * w,\n        a: alpha,\n      });\n    } else if (modelName === 'hsl') {\n      return new Color({\n        h: color1.h + (color2.h - color1.h) * w,\n        s: color1.s + (color2.s - color1.s) * w,\n        l: color1.l + (color2.l - color1.l) * w,\n        a: alpha,\n      });\n    } else if (modelName === 'lab') {\n      const { L: L1, a: a1, b: b1 } = rgbToLab(color1.r, color1.g, color1.b);\n      const { L: L2, a: a2, b: b2 } = rgbToLab(color2.r, color2.g, color2.b);\n\n      return new Color({\n        ...labToRgb(L1 + (L2 - L1) * w, a1 + (a2 - a1) * w, b1 + (b2 - b1) * w),\n        a: alpha,\n      });\n    } else {\n      throwError(\n        ErrorCode.InvalidArgument,\n        'mix()',\n        `\"${modelName}\"`,\n        getSuggestion(modelName, ['hsl', 'lab', 'rgb'])\n      );\n    }\n  },\n  saturate: (c: Value, v: Value): Color => {\n    const color = asColor(c);\n    if (!color) return undefined;\n    return new Color({\n      h: color.h,\n      s: color.s + (1.0 - color.s) * asDecimalRatio(v, 0.1),\n      l: color.l,\n      a: color.a,\n    });\n  },\n  desaturate: (c: Value, v: Value): Color => {\n    const color = asColor(c);\n    if (!color) return undefined;\n    return new Color({\n      h: color.h,\n      s: color.s - color.s * asDecimalRatio(v, 0.1),\n      l: color.l,\n      a: color.a,\n    });\n  },\n  lighten: (c: Value, v: Value): Color => {\n    const color = asColor(c);\n    if (!color) return undefined;\n    return new Color({\n      h: color.h,\n      s: color.s,\n      l: color.l + (1.0 - color.l) * asDecimalRatio(v, 0.1),\n      a: color.a,\n    });\n  },\n  darken: (c: Value, v: Value): Color => {\n    const color = asColor(c);\n    if (!color) return undefined;\n    return new Color({\n      h: color.h,\n      s: color.s,\n      l: color.l - color.l * asDecimalRatio(v, 0.1),\n      a: color.a,\n    });\n  },\n  rotateHue: (c: Value, v: Value): Color => {\n    const color = asColor(c);\n    if (color) {\n      if (!v || (!isAngle(v) && !isNumber(v))) {\n        return color;\n      } else {\n        return new Color({\n          h: (color.h + asDegree(v) + 360) % 360,\n          s: color.s,\n          l: color.l,\n          a: color.a,\n        });\n      }\n    }\n    return undefined;\n  },\n  complement: (c: Value): Color => {\n    const color = asColor(c);\n    if (color) {\n      return new Color({\n        h: (color.h + 180) % 360,\n        s: color.s,\n        l: color.l,\n        a: color.a,\n      });\n    }\n    return undefined;\n  },\n  /**\n   * Return either dark (default #000) or light (default #fff) depending on\n   * the contrast ratio (as per WCAG 2.0 spec)\n   * WCAG 2.0\n   * - AA\n   *     - small text: contrast ratio > 4.5:1\n   *     - large text (18px, bold): contrast ratio > 3.1\n   * - AAA\n   *     - small text: contrast ratio > 7:1\n   *     - large text (18px, bold): contrast ratio > 4.5.1\n   */\n  contrast: (base: Value, dark: Value, light: Value): Color => {\n    const baseColor = asColor(base);\n    const darkColor = asColor(dark) || blackColor;\n    const lightColor = asColor(light) || whiteColor;\n\n    let darkContrast, lightContrast;\n\n    // Calculate contrast ratios for each color\n    // See https://www.w3.org/TR/WCAG20/#contrast-ratiodef\n    const baseLuma = baseColor.luma();\n    const darkLuma = darkColor.luma();\n    const lightLuma = lightColor.luma();\n    if (baseLuma > darkLuma) {\n      darkContrast = (baseLuma + 0.05) / (darkLuma + 0.05);\n    } else {\n      darkContrast = (darkLuma + 0.05) / (baseLuma + 0.05);\n    }\n    if (baseLuma > lightLuma) {\n      lightContrast = (baseLuma + 0.05) / (lightLuma + 0.05);\n    } else {\n      lightContrast = (lightLuma + 0.05) / (baseLuma + 0.05);\n    }\n\n    return darkContrast > lightContrast ? darkColor : lightColor;\n  },\n  rgba: (r, g, b, a): Value =>\n    new Color({\n      r: asDecimalByte(r),\n      g: asDecimalByte(g),\n      b: asDecimalByte(b),\n      a: asDecimalRatio(a, 1.0),\n    }),\n  hsla: (h, s, l, a): Value =>\n    new Color({\n      h: asDegree(h),\n      s: asPercent(s),\n      l: asPercent(l),\n      a: asDecimalRatio(a, 1.0),\n    }),\n  tint: (c: Value, w: Value): Color =>\n    mixColor(whiteColor, c, w ?? new NumberValue(0.1)) as Color,\n  shade: (c: Value, w: Value): Color =>\n    mixColor(blackColor, c, w ?? new NumberValue(0.1)) as Color,\n};\n","import { throwErrorWithContext, ErrorCode, SyntaxError } from './errors';\nimport { terminal } from './terminal';\nimport { getSuggestion } from './utils';\nimport {\n  Value,\n  Frequency,\n  FrequencyUnit,\n  Time,\n  TimeUnit,\n  Length,\n  LengthUnit,\n  BaseLengthUnits,\n  MultiLength,\n  Angle,\n  AngleUnit,\n  StringValue,\n  Percentage,\n  NumberValue,\n  ArrayValue,\n  compareValue,\n  asColor,\n  asInteger,\n  asPercent,\n  asDegree,\n  isArray,\n  isAngle,\n  isColor,\n  isLength,\n  isNumber,\n  isFrequency,\n  isPercentage,\n  isTime,\n  isString,\n  isZero,\n  makeValueFrom,\n  assertLength,\n  scaleLength,\n  promoteToMulti,\n} from './value';\nimport {\n  COLOR_ARGUMENTS_FUNCTIONS,\n  COLOR_FUNCTION_ARGUMENTS,\n  COLOR_FUNCTIONS,\n  scaleColor,\n} from './color-functions';\n\n// @todo: convert frequency and time (1/s -> Hz)\n// @todo: have a base-font-size property in the tokenfile as well (under global: )\n\nexport interface ValueParserOptions {\n  baseUnits?: BaseLengthUnits;\n\n  /** When an alias (identifier in {}) is encountered, this function\n   * is called to resolve it.\n   * Return either the resolved value, or a string which is a suggestion\n   * for the best matching identifier.\n   */\n  aliasResolver?: (identifier: string) => Value | string;\n}\n\n// Definition of the functions that can be used in the expression\n// of token values.\nlet FUNCTIONS: {\n  [key: string]: (...args: Value[]) => Value;\n} = {};\nFUNCTIONS = {\n  /** The calc() function is a no-op, but it's there for compatibility with CSS */\n  calc: (x: Value): Value => x,\n  min: (a: Value, b: Value): Value => {\n    return compareValue(a, b) < 0 ? a : b;\n  },\n  max: (a: Value, b: Value): Value => {\n    return compareValue(a, b) < 0 ? b : a;\n  },\n  clamp(a: Value, b: Value, c: Value): Value {\n    return compareValue(b, a) < 0 ? a : compareValue(b, c) > 0 ? c : b;\n  },\n\n  scale: (arg1: Value, arg2: Value, arg3: Value, arg4: Value): ArrayValue => {\n    if (isColor(arg1)) {\n      return scaleColor(arg1, arg2, arg3, arg4);\n    } else if (isLength(arg1)) {\n      return scaleLength(arg1, arg2);\n    }\n  },\n  ...COLOR_FUNCTIONS,\n};\n\nconst FUNCTION_ARGUMENTS = {\n  calc: 'any',\n  min: 'any, any',\n  max: 'any, any',\n  clamp: 'any, any, any',\n  ...COLOR_FUNCTION_ARGUMENTS,\n};\n\nfunction validateArguments(fn: string, args: any[]): void {\n  const expectedArguments = FUNCTION_ARGUMENTS[fn]\n    ?.split(',')\n    .map((x) => x.trim());\n  if (expectedArguments) {\n    expectedArguments.forEach((x: string, i: number) => {\n      const types = x.split('|').map((x) => x.trim());\n\n      if (!types.includes('none') && !args[i]) {\n        throw new SyntaxError(\n          ErrorCode.MissingArgument,\n          String(i + 1),\n          fn,\n          types.join(', ')\n        );\n      }\n\n      if (\n        args[i] &&\n        !types.includes('any') &&\n        !types.includes(args[i]?.type())\n      ) {\n        throw new SyntaxError(\n          ErrorCode.ExpectedArgument,\n          String(i + 1),\n          fn,\n          types.join(', ')\n        );\n      }\n    });\n    if (args.length > expectedArguments.length) {\n      throw new SyntaxError(\n        ErrorCode.TooManyArguments,\n        fn,\n        expectedArguments.join(', ')\n      );\n    }\n  }\n}\n\nclass Stream {\n  /**\n   * @param {string} s - A token value expression\n   * @param {object} options\n   * @param {number} \"base-font-size\" - The number of pixels of 1rem.\n   */\n  s = '';\n  index = 0;\n  options: ValueParserOptions = {};\n  constructor(s: string, options: ValueParserOptions = {}) {\n    this.s = s;\n    this.index = 0;\n    this.options = options;\n  }\n  isEOF(): boolean {\n    return this.index >= this.s.length;\n  }\n  lookAhead(n: number): string {\n    return this.s.slice(this.index, this.index + n);\n  }\n\n  skipWhiteSpace(): void {\n    this.match(/^\\s*/);\n  }\n  match(target: string): boolean;\n  match(target: RegExp): string;\n  match(target: string | RegExp): string | boolean {\n    if (typeof target === 'string') {\n      if (this.lookAhead(target.length) === target) {\n        this.index += target.length;\n        return target;\n      }\n    } else {\n      const m = this.s.slice(this.index).match(target);\n      if (m && m[0]) {\n        this.index += m[0].length;\n        return m[1] || true;\n      }\n    }\n    return undefined;\n  }\n\n  error(code: ErrorCode, ...args: string[]): void {\n    const prefix = this.s.slice(0, this.index).match(/^(.*)/)?.[1] ?? '';\n    const suffix = this.s.slice(this.index).match(/(.*)$/)?.[1] ?? '';\n    throwErrorWithContext(\n      [prefix + terminal.dim(suffix), ' '.repeat(prefix.length) + '⇧'],\n      code,\n      ...args\n    );\n  }\n\n  /** Apply an arithmetic operation when at least one of the operands is a Length\n   *\n   */\n  applyOpToLength(\n    op: string,\n    lhs: Length | NumberValue,\n    rhs: Length | NumberValue\n  ): Value {\n    if (isNumber(lhs) && op === '/') this.error(ErrorCode.InvalidOperand);\n    if (!isNumber(lhs) && !isNumber(rhs) && op === '*')\n      this.error(ErrorCode.InvalidOperand);\n\n    const opFn = {\n      '+': (a: any, b: any): any => a + b,\n      '-': (a: any, b: any): any => a - b,\n      '*': (a: any, b: any): any => a * b,\n      '/': (a: any, b: any): any => a / b,\n    }[op];\n\n    if (isNumber(lhs)) {\n      assertLength(rhs);\n      if (rhs.unit === 'multi') {\n        const multiLength = {};\n        Object.keys(rhs.value as MultiLength).forEach((unit) => {\n          multiLength[unit] = opFn(lhs.value, rhs.value[unit]);\n        });\n        return new Length(multiLength);\n      }\n      return new Length(opFn(lhs.value, rhs.value), rhs.unit);\n    }\n    if (isNumber(rhs)) {\n      if (typeof lhs.value === 'number') {\n        return new Length(opFn(lhs.value, rhs.value), lhs.unit);\n      }\n      const multiLength = {};\n      Object.keys(lhs.value as MultiLength).forEach((unit) => {\n        multiLength[unit] = opFn(lhs.value[unit], rhs.value);\n      });\n      return new Length(multiLength);\n    }\n    // We've dealt with the case where one of the two operand is a number.\n    // Now, both operands are Length\n    if (op === '/') {\n      if (lhs.unit === 'multi' || rhs.unit === 'multi') {\n        this.error(ErrorCode.InvalidOperand);\n      }\n\n      if (lhs.unit === rhs.unit) {\n        // If the units are the same, we can calculate the result\n        // even if the units are relative (em, vh, etc...)\n        return new NumberValue((lhs.value as number) / (rhs.value as number));\n      } else {\n        // The units are not the same. Attempt to conver them to a scalar\n        return new NumberValue(lhs.canonicalScalar() / rhs.canonicalScalar());\n      }\n    }\n    // Normalize them both to multi-units\n    const lhsMulti = promoteToMulti(lhs);\n    const rhsMulti = promoteToMulti(rhs);\n\n    // Apply the operation on the union of both operands\n    const multiLength = {};\n    [\n      ...Object.keys(lhsMulti.value as MultiLength),\n      ...Object.keys(rhsMulti.value as MultiLength),\n    ].forEach((unit) => {\n      if (typeof rhsMulti.value[unit] === 'undefined') {\n        multiLength[unit] = lhsMulti.value[unit];\n      } else if (typeof lhsMulti.value[unit] === 'undefined') {\n        multiLength[unit] = rhsMulti.value[unit];\n      } else {\n        multiLength[unit] = opFn(lhsMulti.value[unit], rhsMulti.value[unit]);\n      }\n    });\n    return new Length(multiLength);\n  }\n\n  parseUnit(num: number): Value {\n    // Check if a number (or group) is followed (immediately) by a unit\n    if (this.match('%')) {\n      return new Percentage(num);\n    }\n    let unit = this.match(\n      /^(em|ex|ch|rem|vw|vh|vmin|vmax|px|cm|mm|in|pt|pc|Q)/\n    );\n    if (unit) {\n      return new Length(num, unit as LengthUnit);\n    }\n    unit = this.match(/^(deg|°|rad|grad|turn)/);\n    if (unit) {\n      return new Angle(num, (unit === '°' ? 'deg' : unit) as AngleUnit);\n    }\n    unit = this.match(/^(ms|s)/);\n    if (unit) {\n      return new Time(num, unit as TimeUnit);\n    }\n    unit = this.match(/^(khz|hz|kHz|Hz)/);\n    if (unit) {\n      return new Frequency(num, unit.toLowerCase() as FrequencyUnit);\n    }\n    unit = this.match(/^([a-zA-Z]+)/);\n    if (unit) {\n      this.error(ErrorCode.UnknownUnit, unit);\n    }\n    return new NumberValue(num);\n  }\n\n  parseIndex(v: Value): Value {\n    let result = v;\n    if (this.match('[')) {\n      if (v.type() !== 'array') {\n        this.error(ErrorCode.UnexpectedOpenBracket);\n      } else {\n        const index = asInteger(this.parseExpression(), NaN);\n        if (isNaN(index)) this.error(ErrorCode.ExpectedIntegerIndex);\n        result = (v as ArrayValue).get(index);\n        this.skipWhiteSpace();\n        if (!this.match(']')) {\n          this.error(ErrorCode.ExpectedCloseBracket);\n        }\n      }\n    }\n    return result;\n  }\n\n  parseLiteral(): Value {\n    let result: Value;\n    const saveIndex = this.index;\n    const op = this.match(/^\\s*([+\\-])\\s*/);\n    if (op) {\n      const operand = this.parseLiteral();\n      if (op === '-') {\n        // Unary operator\n        if (isPercentage(operand)) {\n          return new Percentage(-100 * asPercent(operand));\n        }\n        if (isNumber(operand)) {\n          return new NumberValue(-operand.value);\n        }\n        if (isAngle(operand)) {\n          return new Angle(-operand.value, operand.unit);\n        }\n        if (isLength(operand)) {\n          return this.applyOpToLength('-', new Length(0, 'px'), operand);\n        }\n        this.error(ErrorCode.InvalidUnaryOperand);\n      }\n      return operand;\n    }\n\n    const num = this.match(/^([0-9]*\\.[0-9]+|\\.?[0-9]+)/);\n    if (num) {\n      result = this.parseUnit(parseFloat(num));\n    }\n\n    if (!result && this.match('[')) {\n      // It's an array literal\n      const array = [];\n      while (this.lookAhead(1) !== ']' && !this.isEOF()) {\n        const element = this.parseExpression();\n        if (!element) {\n          this.error(ErrorCode.SyntaxError);\n        }\n        array.push(element);\n        this.match(/^(\\s*,?|\\s+)/);\n      }\n\n      if (this.isEOF()) {\n        this.error(ErrorCode.ExpectedCloseBracket);\n      }\n      this.match(']');\n      return new ArrayValue(array);\n    }\n\n    if (!result && this.match('\"')) {\n      // It's a string\n      let s = '';\n      while (this.lookAhead(1) !== '\"' && !this.isEOF()) {\n        if (this.lookAhead(1) === '\\\\') {\n          // Escape character\n          s += this.s[this.index + 1];\n          this.index += 2;\n        } else {\n          s += this.s[this.index];\n          this.index += 1;\n        }\n      }\n\n      if (this.isEOF()) {\n        this.error(ErrorCode.ExpectedQuote);\n      }\n      this.match('\"');\n      return new StringValue(s);\n    }\n\n    if (!result && this.match('{')) {\n      // It's an alias\n      const identifier = this.match(/^([a-zA-Z_-][a-zA-Z0-9\\._-]*)/);\n      if (identifier) {\n        let alias = this.options?.aliasResolver(identifier);\n        if (typeof alias === 'string') {\n          // If that didn't work, try an implicit color scale...\n          // e.g. \"red-200\"\n          const m = identifier.match(/^(.+)-([0-9]{2,3})$/);\n          if (m) {\n            const resolvedValue = this.options?.aliasResolver(m[1]);\n            if (typeof resolvedValue !== 'string') {\n              if (isArray(resolvedValue)) {\n                const index = Math.round(parseInt(m[2]) / 100);\n                alias = resolvedValue.get(index);\n              } else if (isColor(resolvedValue)) {\n                const index = Math.round(parseInt(m[2]) / 100);\n\n                alias = scaleColor(resolvedValue)?.get(index);\n              } else if (isLength(resolvedValue)) {\n                const index =\n                  m[2] === '50' ? 0 : Math.round(parseInt(m[2]) / 100);\n                alias = scaleLength(resolvedValue)?.get(index);\n              }\n            } else if (typeof resolvedValue === 'string') {\n              // A string indicate the identifier could not be\n              // resolved. The string is the suggestion\n              this.error(ErrorCode.UnknownToken, m[1], resolvedValue);\n            } else this.error(ErrorCode.InvalidOperand);\n          }\n        }\n        if (typeof alias === 'string') {\n          this.error(ErrorCode.UnknownToken, identifier, alias);\n        }\n        result = alias as Value;\n        if (result) {\n          // Clone the result of the alias, since we'll need to change\n          // the source\n          result = makeValueFrom(result);\n          result.setSource('{' + identifier + '}');\n        }\n      }\n      if (!this.match('}')) {\n        this.error(ErrorCode.ExpectedCloseCurlyBracket);\n      }\n    }\n\n    if (!result) {\n      // Attempt to parse a color as a hex value\n      result = asColor(this.match(/^\\s*(#[0-9a-fA-F]{3,8})/));\n    }\n    if (!result) {\n      // Backtrack and attempt to parse as a color name\n      this.index = saveIndex;\n      result = asColor(this.match(/^\\s*([a-zA-Z]+)/));\n    }\n    if (!result) {\n      // Backtrack\n      this.index = saveIndex;\n    }\n    return result;\n  }\n\n  /* Argument to color functions (rgb, hsl, etc...) have a bit of \n    a peculiar syntax. The arguments can be either comma or space delimited, \n    and the last one (the opacity) can be space, comma or \"/\". \n    And it's optional */\n  parseColorArguments(): (Value | Value)[] {\n    const result: (Value | Value)[] = [];\n\n    this.skipWhiteSpace();\n    if (!this.match('(')) return undefined;\n\n    let arg = this.parseExpression();\n    if (arg) {\n      result.push(arg);\n\n      if (!this.match(/^(\\s*,?|\\s+)/)) {\n        this.match(')');\n        return result;\n      }\n\n      arg = this.parseExpression();\n      if (arg) {\n        result.push(arg);\n\n        if (!this.match(/^(\\s*,?|\\s+)/)) {\n          this.match(')');\n          return result;\n        }\n\n        arg = this.parseExpression();\n        if (arg) {\n          result.push(arg);\n\n          // Last argument (opacity) can be separated with a \"slash\"\n          if (!this.match(/^(\\s*,?|\\s+|\\s*\\/)/)) {\n            this.match(')');\n            return result;\n          }\n\n          arg = this.parseExpression();\n          if (arg) {\n            result.push(arg);\n          }\n        }\n      }\n    }\n\n    this.match(')');\n\n    return result;\n  }\n\n  parseArguments(): Value[] {\n    this.skipWhiteSpace();\n    if (!this.match('(')) return undefined;\n\n    const result = [];\n    while (this.lookAhead(1) !== ')' && !this.isEOF()) {\n      const argument = this.parseExpression();\n      if (!argument) {\n        this.error(ErrorCode.SyntaxError);\n      }\n      result.push(argument);\n      this.match(/^(\\s*,?|\\s+)/);\n    }\n    if (this.isEOF()) {\n      this.error(ErrorCode.ExpectedCloseParen);\n    }\n    this.match(')');\n\n    return result;\n  }\n\n  parseCall(): Value {\n    const saveIndex = this.index;\n    const fn = this.match(/^([a-zA-Z\\-]+)/);\n    if (fn) {\n      if (!FUNCTIONS[fn]) {\n        if (this.lookAhead(1) === '(') {\n          this.error(\n            ErrorCode.UnknownFunction,\n            fn,\n            getSuggestion(fn, FUNCTIONS)\n          );\n        }\n      } else {\n        const args = COLOR_ARGUMENTS_FUNCTIONS.includes(fn)\n          ? this.parseColorArguments()\n          : this.parseArguments();\n        if (args) {\n          try {\n            validateArguments(fn, args);\n          } catch (err) {\n            if (err.code) {\n              this.error(err.code, ...err.args);\n            } else {\n              this.error(err.message);\n            }\n          }\n          return FUNCTIONS[fn](...args);\n        } else {\n          this.error(ErrorCode.SyntaxError);\n        }\n      }\n    }\n    // Backtrack\n    this.index = saveIndex;\n    return undefined;\n  }\n\n  parseTerminal(): Value {\n    const result = this.parseCall() || this.parseGroup() || this.parseLiteral();\n\n    if (!result) return result;\n\n    return this.parseIndex(result);\n  }\n\n  parseFactor(): Value {\n    let lhs = this.parseTerminal();\n\n    let op = this.match(/^\\s*([*|/])\\s*/);\n    while (op) {\n      const opFn = {\n        '*': (a: any, b: any): any => a * b,\n        '/': (a: any, b: any): any => a / b,\n      }[op];\n      // Multiplication or division\n      const rhs = this.parseTerminal();\n\n      if (!rhs) this.error(ErrorCode.ExpectedOperand);\n      // Type combination rules (for * AND /)\n      // ---\n      // num * num            -> num\n      // num * angle          -> angle\n      // num * percent        -> percent\n      // num * length         -> length\n      // Other combinations are invalid, but division of two\n      // values of the same type is valid (and yields a unitless number)\n      if (isNumber(rhs)) {\n        if (isNumber(lhs)) {\n          lhs = new NumberValue(opFn(lhs.value, rhs.value));\n        } else if (isPercentage(lhs)) {\n          lhs = new Percentage(opFn(lhs.value, rhs.value));\n        } else if (isLength(lhs)) {\n          lhs = this.applyOpToLength(op, lhs, rhs);\n        } else if (isAngle(lhs)) {\n          lhs = new Angle(opFn(lhs.value, rhs.value), lhs.unit);\n        } else if (isFrequency(lhs)) {\n          lhs = new Frequency(opFn(lhs.value, rhs.value), lhs.unit);\n        } else if (isTime(lhs)) {\n          lhs = new Time(opFn(lhs.value, rhs.value), lhs.unit);\n        }\n      } else if ((isNumber(lhs) || isLength(lhs)) && isLength(rhs)) {\n        return this.applyOpToLength(op, lhs, rhs);\n      } else if (isNumber(lhs)) {\n        if (isPercentage(rhs)) {\n          lhs = new Percentage(opFn(lhs.value, rhs.value));\n        } else if (isLength(rhs)) {\n          lhs = this.applyOpToLength(op, lhs, rhs);\n        } else if (isAngle(rhs)) {\n          lhs = new Angle(opFn(lhs.value, rhs.value), rhs.unit);\n        } else if (isFrequency(rhs)) {\n          lhs = new Frequency(opFn(lhs.value, rhs.value), rhs.unit);\n        } else if (isTime(rhs)) {\n          lhs = new Time(opFn(lhs.value, rhs.value), rhs.unit);\n        }\n      } else if (op === '/' && lhs.type() === rhs.type()) {\n        lhs = new NumberValue(lhs.canonicalScalar() / rhs.canonicalScalar());\n      } else {\n        this.error(ErrorCode.InvalidOperand);\n      }\n      op = this.match(/^\\s*([*|/])\\s*/);\n    }\n\n    return lhs;\n  }\n\n  parseTerm(): Value {\n    let lhs = this.parseFactor();\n\n    let op = this.match(/^\\s*([+\\-])\\s*/);\n\n    while (op) {\n      const opFn = {\n        '+': (a: any, b: any): any => a + b,\n        '-': (a: any, b: any): any => a - b,\n      }[op];\n      // Type combination rules (for + AND -)\n      // ---\n      // string + any             -> string\n      // any + string             -> string\n      // num + num                -> num\n      // percentage + num         -> percent\n      // num + percentage         -> percent\n      // percentage + percentage  -> percent\n      // angle + angle            -> angle\n      // length + length          -> length\n      // Other combinations are invalid.\n      const rhs = this.parseFactor();\n\n      if (!rhs) this.error(ErrorCode.ExpectedOperand);\n\n      if (isString(lhs) || isString(rhs)) {\n        if (op === '-') this.error(ErrorCode.InvalidOperand);\n        lhs = new StringValue(opFn(lhs.css(), rhs.css()));\n      } else if (isNumber(lhs) && isNumber(rhs)) {\n        lhs = new NumberValue(opFn(lhs.value, rhs.value));\n      } else if (\n        (isZero(lhs) || isPercentage(lhs)) &&\n        (isZero(rhs) || isPercentage(rhs))\n      ) {\n        lhs = new Percentage(100 * opFn(asPercent(lhs), asPercent(rhs)));\n      } else if (isZero(lhs) && isTime(rhs)) {\n        lhs = new Time(opFn(0, rhs.value), rhs.unit);\n      } else if (isTime(lhs) && isZero(rhs)) {\n        lhs = new Time(lhs.value, lhs.unit);\n      } else if (isTime(lhs) && isTime(rhs)) {\n        if (lhs.unit === rhs.unit) {\n          lhs = new Time(opFn(lhs.value, rhs.value), lhs.unit);\n        } else {\n          lhs = new Time(\n            opFn(lhs.canonicalScalar(), rhs.canonicalScalar()),\n            's'\n          );\n        }\n      } else if (isZero(lhs) && isFrequency(rhs)) {\n        lhs = new Frequency(opFn(0, rhs.value), rhs.unit);\n      } else if (isFrequency(lhs) && isZero(rhs)) {\n        lhs = new Frequency(lhs.value, lhs.unit);\n      } else if (isFrequency(lhs) && isFrequency(rhs)) {\n        if (lhs.unit === rhs.unit) {\n          lhs = new Frequency(opFn(lhs.value, rhs.value), lhs.unit);\n        } else {\n          lhs = new Frequency(\n            opFn(lhs.canonicalScalar(), rhs.canonicalScalar()),\n            'hz'\n          );\n        }\n      } else if (isZero(lhs) && isAngle(rhs)) {\n        lhs = new Angle(opFn(0, rhs.value), rhs.unit);\n      } else if (isAngle(lhs) && isZero(rhs)) {\n        lhs = new Angle(lhs.value, lhs.unit);\n      } else if (isAngle(lhs) && isAngle(rhs)) {\n        if (lhs.unit === rhs.unit) {\n          lhs = new Angle(opFn(lhs.value, rhs.value), lhs.unit);\n        } else {\n          lhs = new Angle(opFn(asDegree(lhs), asDegree(rhs)), 'deg');\n        }\n      } else if (\n        (isZero(lhs) || isLength(lhs)) &&\n        (isZero(rhs) || isLength(rhs))\n      ) {\n        lhs = this.applyOpToLength(op, lhs, rhs);\n      } else {\n        this.error(ErrorCode.InvalidOperand);\n      }\n      op = this.match(/^\\s*([+\\-])\\s*/);\n    }\n\n    return lhs;\n  }\n\n  parseGroup(): Value {\n    let result: Value;\n    if (this.match('(')) {\n      result = this.parseExpression();\n      this.skipWhiteSpace();\n      if (!this.match(')')) {\n        this.error(ErrorCode.ExpectedCloseParen);\n      }\n    }\n\n    if (result && isNumber(result)) {\n      // If the value of the group is a number\n      // check and handle units that might be after it.\n      // \"(12 + 5)px\"\n      result = this.parseUnit(result.value);\n    }\n\n    return result;\n  }\n\n  parseExpression(): Value {\n    this.skipWhiteSpace();\n    return this.parseTerm();\n  }\n}\n\nexport function parseValue(\n  expression: string,\n  options: ValueParserOptions = {}\n): Value {\n  const stream = new Stream(expression, options);\n  const result = stream.parseExpression();\n  stream.skipWhiteSpace();\n  if (!stream.isEOF()) {\n    // There was some additional content that we couldn't parse.\n    // Return 'undefined' to avoid partially parsing things\n    // that shouldn't be. For example \"3px red\" should\n    // be interpreted as a string, not as \"3px\".\n    return undefined;\n  }\n  if (result) {\n    result.setSource(expression);\n  }\n  return result;\n}\n","/*\n- json/asset\n- json/nested\n- json/flat\n- sketch/palette\n- sketch/palette/v2\n*/\nconst fs = require('fs');\n\nimport { Format, RenderContext } from './formats';\n\nexport const GenericFormats: { formats: { [key: string]: Format } } = {\n  formats: {\n    'yaml': {\n      ext: '.yaml',\n\n      render: (context: RenderContext): string =>\n        context.renderTemplate(\n          fs.readFileSync(__dirname + '/templates/yaml.hbs', 'utf-8'),\n          context\n        ),\n    },\n\n    'json': {\n      ext: '.json',\n\n      render: (context: RenderContext): string =>\n        context.renderTemplate(\n          fs.readFileSync(__dirname + '/templates/json.hbs', 'utf-8'),\n          context\n        ),\n\n      handlebarsHelpers: {},\n    },\n    'data-dump': {\n      ext: '.yaml',\n\n      render: (context: RenderContext): string =>\n        context.renderTemplate(\n          fs.readFileSync(__dirname + '/templates/data-dump.hbs', 'utf-8'),\n          context\n        ),\n    },\n  },\n};\n","// @todo more formats (https://github.com/amzn/style-dictionary/blob/3d0d1c0356d42fc83f905a7e7e4b1c662c77de0b/lib/common/formats.js)\n\n// xCode .colorset: https://developer.apple.com/library/archive/documentation/Xcode/Reference/xcode_ref-Asset_Catalog_Format/Named_Color.html#//apple_ref/doc/uid/TP40015170-CH59-SW1\n\n/*\n- sketch/palette\n- sketch/palette/v2\n*/\n\nconst fs = require('fs');\nimport { Format, RenderContext } from './formats';\n\nexport const WebFormats: { formats: { [key: string]: Format } } = {\n  formats: {\n    sass: {\n      ext: '.scss',\n      render: (context: RenderContext): string =>\n        context.renderTemplate(\n          fs.readFileSync(__dirname + '/templates/sass.hbs', 'utf-8'),\n          context\n        ),\n    },\n    css: {\n      ext: '.css',\n      render: (context: RenderContext): string =>\n        context.renderTemplate(\n          fs.readFileSync(__dirname + '/templates/css.hbs', 'utf-8'),\n          context\n        ),\n    },\n  },\n};\n","const marked = require('marked');\nconst highlight = require('highlight.js');\nconst handlebars = require('handlebars');\nconst fs = require('fs');\n\nimport { Color, isColor, isColorArray, roundTo } from './value';\nimport { getSimilarColors, getDeltaE, filterColor } from './color-functions';\nimport { RenderContext, Format } from './formats';\n\nfunction renderColorSection(context: RenderContext): string {\n  let result = '';\n  const handlebarsContext = { colors: [], colorRamps: [], group: '' };\n  const allColors: { name: string; color: Color }[] = [];\n  context.themes.forEach((theme) => {\n    theme.tokens.forEach((token) => {\n      if (isColor(token.tokenValue))\n        allColors.push({\n          name:\n            token.tokenId +\n            (theme.theme === '_' || theme.theme === ''\n              ? ''\n              : '.' + theme.theme),\n          color: token.tokenValue,\n        });\n    });\n  });\n\n  context.themes.forEach((theme) => {\n    handlebarsContext.group =\n      context.themes.length === 1\n        ? ''\n        : theme.theme === '_'\n        ? 'Base'\n        : theme.theme;\n    handlebarsContext.colors = [];\n    theme.tokens.forEach((token) => {\n      if (isColor(token.tokenValue)) {\n        const color = token.tokenValue as Color;\n        let cls = color.luma() >= 1.0 ? 'frame ' : '';\n        if (color.luma() > 0.42) cls += 'light';\n        let opaqueColor: Color;\n        if (color.a < 1.0) {\n          opaqueColor = new Color(color);\n          opaqueColor.a = 1.0;\n        }\n        const similarColors = getSimilarColors(color, allColors);\n        const similarProtanopiaColors = getSimilarColors(\n          color,\n          allColors,\n          'protanopia'\n        );\n        const similarDeuteranopiaColors = getSimilarColors(\n          color,\n          allColors,\n          'deuteranopia'\n        )?.filter((x) => !similarColors?.includes(x));\n        const similarTritanopiaColors = getSimilarColors(\n          color,\n          allColors,\n          'tritanopia'\n        );\n        const similarColorsColorDeficient = [];\n        [\n          ...(similarDeuteranopiaColors ?? []),\n          ...(similarTritanopiaColors ?? []),\n          ...(similarProtanopiaColors ?? []),\n        ].forEach((x) => {\n          // Add to the list if it's not:\n          // 1/ already in the list and\n          // 2/ not in the \"normal\" similar colors\n          // We want this list to only include colors that are similar\n          // for people with color deficiency\n          if (\n            similarColorsColorDeficient.findIndex((y) => y.name === x.name) < 0\n          ) {\n            if (\n              !similarColors ||\n              similarColors.findIndex((y) => y.name === x.name) < 0\n            ) {\n              similarColorsColorDeficient.push(x);\n            }\n          }\n        });\n        handlebarsContext.colors.push({\n          name: token.tokenId,\n          value: token.tokenValue,\n          source: color.getSource(),\n          css: color.css(),\n          protanopiaCss: filterColor(color, 'protanopia').css(),\n          deuteranopiaCss: filterColor(color, 'deuteranopia').css(),\n          tritanopiaCss: filterColor(color, 'tritanopia').css(),\n          comment: token.tokenDefinition.comment ?? '',\n          cls,\n          opaqueColor: opaqueColor?.css(),\n          similarColors: {\n            normal: similarColors\n              ? similarColors.map((x) => {\n                  return {\n                    name: x.name,\n                    css: x.color.css(),\n                    deltaE: roundTo(x.deltaE, 2),\n                  };\n                })\n              : null,\n            colorDeficient: similarColorsColorDeficient\n              ? similarColorsColorDeficient.map((x) => {\n                  return {\n                    name: x.name,\n                    css: x.color.css(),\n                    deltaE: roundTo(x.deltaE, 2),\n                  };\n                })\n              : null,\n            protanopia: similarProtanopiaColors\n              ? similarProtanopiaColors.map((x) => {\n                  return {\n                    name: x.name,\n                    css: x.color.css(),\n                    deltaE: roundTo(x.deltaE, 2),\n                  };\n                })\n              : null,\n            deuteranopia: similarDeuteranopiaColors\n              ? similarDeuteranopiaColors.map((x) => {\n                  return {\n                    name: x.name,\n                    css: x.color.css(),\n                    deltaE: roundTo(x.deltaE, 2),\n                  };\n                })\n              : null,\n            tritanopia: similarTritanopiaColors\n              ? similarTritanopiaColors.map((x) => {\n                  return {\n                    name: x.name,\n                    css: x.color.css(),\n                    deltaE: roundTo(x.deltaE, 2),\n                  };\n                })\n              : null,\n          },\n        });\n      } else if (isColorArray(token.tokenValue)) {\n        let previousColor;\n        handlebarsContext.colorRamps.push({\n          name: token.tokenId,\n          source: token.tokenValue.getSource(),\n          values: token.tokenValue.value.map((x, i) => {\n            const color = x as Color;\n            let cls = color.luma() >= 1.0 ? 'frame ' : '';\n            if (color.luma() > 0.42) cls += 'light';\n            let opaqueColor: Color;\n            if (color.a < 1.0) {\n              opaqueColor = new Color(color);\n              opaqueColor.a = 1.0;\n            }\n            const deltaEWithPrevious =\n              previousColor && getDeltaE(color, previousColor);\n            previousColor = color;\n            return {\n              name: i === 0 ? '50' : i * 100,\n              cls,\n              value: color,\n              css: color.css(),\n              opaqueColor: opaqueColor?.css(),\n              deltaE:\n                deltaEWithPrevious < 2\n                  ? roundTo(deltaEWithPrevious, 2)\n                  : undefined,\n            };\n          }),\n        });\n      }\n    });\n    result += handlebars.compile(\n      fs.readFileSync(__dirname + '/templates/html-colors.hbs', 'utf-8')\n    )(handlebarsContext);\n  });\n\n  return result;\n}\n\nexport const StyleGuideFormat: { formats: { [key: string]: Format } } = {\n  formats: {\n    'html/colors': {\n      ext: '.html',\n      render: renderColorSection,\n    },\n    'html': {\n      ext: '.html',\n      render: (context: RenderContext): string =>\n        context.renderTemplate(\n          fs.readFileSync(__dirname + '/templates/html-file.hbs', 'utf-8'),\n          { ...context, 'color-section': renderColorSection(context) }\n        ),\n    },\n  },\n};\n\nmarked.setOptions({\n  renderer: new marked.Renderer(),\n  highlight: (code: string): string => highlight.highlightAuto(code).value,\n  pedantic: false,\n  gfm: true,\n  breaks: false,\n  sanitize: false,\n  smartLists: true,\n  smartypants: false,\n  xhtml: false,\n});\n","// @todo: breakpoints (using a 'breakpoint:' instead of 'value:' property)\n// and media queries\n// @todo: compatibility with theo design tokens, support {!} style alias\n\nconst { cosmiconfigSync } = require('cosmiconfig');\nconst configParser = cosmiconfigSync('chromatic');\nconst glob = require('glob');\nconst fs = require('fs-extra');\nconst path = require('path');\nconst yaml = require('yaml');\nconst json5 = require('json5');\nconst resolveFrom = require('resolve-from');\nconst handlebars = require('handlebars');\n\nimport { throwErrorIf, ErrorCode } from './errors';\nimport { getSuggestion } from './utils';\nimport { DefaultFormatters } from './default-formatters';\nimport {\n  Format,\n  TokenDefinition,\n  TokenGroupInfo,\n  DEFAULT_FILE_HEADER,\n  RenderContext,\n} from './formats';\nimport { Value, StringValue, isString } from './value';\nimport { parseValue, ValueParserOptions } from './value-parser';\n\nimport { GenericFormats } from './formats-generic';\nimport { WebFormats } from './formats-web';\nimport { StyleGuideFormat } from './formats-styleguide';\n\nimport { terminal } from './terminal';\n\n//\n// Type definitions\n//\n\ntype TokenGroup = { [token: string]: TokenDefinition | TokenGroup };\n\ninterface TokenFile {\n  theme?: string;\n  import: string | string[];\n  groups?: { [group: string]: TokenGroupInfo };\n  tokens: TokenGroup;\n}\n\n/** The configuration settings that can be defined in a configuration file\n */\n\ninterface Config extends ValueParserOptions {\n  tokenFileExt?: string;\n  verbose?: boolean;\n\n  /** All the themes to generate output for */\n  themes?: string[];\n\n  /** The default theme when none is provied */\n  defaultTheme?: string;\n\n  /** The output format */\n  outputFormat?: string;\n\n  /** If true, themes are output in separate files. Otherwise, they're\n   * combined in a single file\n   */\n  splitOutput?: boolean;\n\n  /** A list of custom output formats */\n  formats?: { [key: string]: Format };\n  handlebarsHelpers?: { [helper: string]: (...args: string[]) => string };\n\n  /** An object to output error and log messages to (defaults to the system\n   * console) */\n  console?: {\n    error: (m: string) => void;\n    log: (m: string) => void;\n  };\n  [key: string]: unknown;\n}\n\n/**\n * The parameters that can be specified in a token file, or overridden\n * as an option\n */\n// interface Settings {\n//     colorSimilarityThreshold: number;\n//     colorDeficiencySimilariryThreshold: number;\n// }\n\n/** The set of options that can be passed to the chromatic() function\n * or to the CLI tool\n */\ninterface Options {\n  /** If true, only do validation of token files and formats */\n  dryRun: boolean;\n\n  /** Path to a config file */\n  config: string;\n\n  /** A comma delimited list or an array of themes to be processed */\n  themes: string | string[];\n\n  /** The default file extension for token files (when scanning a directory */\n  tokenFileExt: string;\n\n  /** If true, output additional info during processing */\n  verbose: boolean;\n\n  /** Output format */\n  format: string;\n\n  /** Output file or directory */\n  output: string;\n\n  /** A map of custom helper function for handlebar templates */\n  handlebarsHelpers: { [helper: string]: (...args: string[]) => string };\n\n  /** If true, the process is in 'watch' mode */\n  watching: boolean;\n\n  /** If true, attempt to continue when an error is encountered */\n  ignoreErrors: boolean;\n\n  /** Header to include at the top of each generated file */\n  header: string;\n\n  /**  Split themes in multiple files. */\n  splitOutput?: boolean;\n\n  /** An object to capture error and log messages to (defaults to the system\n   * console) */\n  console?:\n    | {\n        error: (m: string) => void;\n        log: (m: string) => void;\n      }\n    | string;\n}\n\n//\n// Globals\n//\n\nconst gConfig: Config = {};\n\n/** True if in --watch mode */\nlet gWatching = false;\n\n/** True if an attempt to continue should be made after encountering an error */\nlet gIgnoreErrors = false;\n\n/** The themes and groups encountered while parsing */\nlet gThemes: string[];\n\n/** The groups encountered while parsing (and their associated metadata) */\nlet gGroups: Map<string, TokenGroupInfo>;\n\n/** The key is a token path ('semantic.warning') and the value is\n * the definition of the tokens, including its values (as Value objects)\n * for each theme it has a definition for (including the default theme, '_')\n */\nlet gTokenDefinitions: Map<string, TokenDefinition>;\n\n/** For a given qualified token (e.g. 'semantic.warning.dark'), its value */\nlet gTokenValues: Map<string, Value>;\n\n/**  The qualified token names that are in the process of being evaluated. Used to detect recursive definitions. */\nlet gRecursiveEvaluationStack: string[];\n\n/** Tokens that have failed to evaluate. */\n/* We keep track of them to avoid repetitive error messages */\nlet gErroredTokens: string[];\n\n/* Paths of the processed files (used to detect and prevent circular references) */\nlet gProcessedFiles: string[];\n\nfunction error(m: string | string[]): void {\n  if (typeof m === 'string') m = [m];\n\n  // If there are any carriage returns, break them up in separate array elements\n  const msg = '\\n' + [].concat(...m.map((x) => x.split('\\n'))).join('\\n    ');\n\n  gConfig.console?.error(terminal.autoFormat(msg));\n\n  if (!gWatching && !gIgnoreErrors) {\n    process.exit(1);\n  }\n}\n\nfunction log(m: string): void {\n  gConfig.console?.log(m);\n}\n\n/**\n * Merge \"source\" into object by doing a deep copy of enumerable properties.\n */\nfunction mergeObject(\n  object: Record<string, unknown>,\n  source: Record<string, unknown>\n): Record<string, unknown> {\n  if (object === source) return;\n  if (!source) return;\n  Object.keys(source).forEach((key) => {\n    if (Array.isArray(source[key])) {\n      if (!object[key]) object[key] = [];\n      object[key] = [\n        ...(object[key] as unknown[]),\n        ...(source[key] as unknown[]),\n      ];\n    } else if (typeof source[key] === 'object') {\n      // Object literal\n      if (!object[key]) object[key] = {};\n      mergeObject(\n        object[key] as Record<string, unknown>,\n        source[key] as Record<string, unknown>\n      );\n    } else if (typeof source[key] !== 'undefined') {\n      object[key] = source[key];\n    }\n  });\n}\n\n/**\n * Return a normalized token value, with default theme applied\n *\n */\nfunction normalizeToken(\n  defaultTheme: string,\n  entry: string | TokenDefinition\n): TokenDefinition {\n  if (\n    typeof entry !== 'string' &&\n    (typeof entry !== 'object' || !entry.value)\n  ) {\n    return undefined;\n  }\n  let result: TokenDefinition = { value: {} };\n  if (typeof entry === 'string') {\n    result.value._ = entry;\n  } else {\n    result = { ...entry };\n  }\n  if (typeof result.value === 'string') {\n    result.value = { _: result.value };\n  }\n\n  // If there is a default theme, apply it now\n  if (defaultTheme && result.value['_']) {\n    result.value[defaultTheme] = result.value['_'];\n    result.value['_'] = undefined;\n  }\n\n  Object.keys(result.value).forEach((theme) => {\n    if (!gThemes.includes(theme)) {\n      gThemes.push(theme);\n    }\n  });\n\n  return result;\n}\n\n/**\n * Evaluate an expression (e.g. \"18pt + 5px\" or \"darken(crimson)\") and\n * return a corresponding value.\n *\n * Aliases (denoted by a pair of curly brackets) are resolved.\n *\n */\nfunction evaluateTokenExpression(\n  qualifiedToken: string,\n  expression: string,\n  theme: string\n): Value {\n  if (!expression) return undefined;\n  if (gErroredTokens.includes(qualifiedToken)) return undefined;\n\n  try {\n    throwErrorIf(\n      gRecursiveEvaluationStack.includes(qualifiedToken),\n      ErrorCode.CircularDefinition,\n      qualifiedToken\n    );\n\n    gRecursiveEvaluationStack.push(qualifiedToken);\n\n    const result = parseValue(expression, {\n      ...gConfig,\n      aliasResolver: (identifier): Value | string => {\n        // If we have already evaluated this token, return its value\n        let aliasValue: Value;\n        if (theme) {\n          if (gTokenValues.has(identifier + '.' + theme))\n            return gTokenValues.get(identifier + '.' + theme);\n          if (gTokenDefinitions.has(identifier)) {\n            // There is a token definition with that name\n            // Let's try for a value for the current theme\n            aliasValue = evaluateTokenExpression(\n              identifier + '.' + theme,\n              gTokenDefinitions.get(identifier)?.value[theme] ??\n                gTokenDefinitions.get(qualifiedToken)?.value['_'],\n              theme\n            );\n          }\n          if (aliasValue) return aliasValue;\n        }\n        if (gTokenValues.has(identifier)) return gTokenValues.get(identifier);\n\n        // The token 'identifier' has not been evaluated yet.\n        // Let's try to evaluate it now.\n        if (gTokenDefinitions.has(identifier)) {\n          // There is a token definition with that name\n          // Let's try for a value for the current theme\n          if (theme) {\n            aliasValue = evaluateTokenExpression(\n              identifier + '.' + theme,\n              gTokenDefinitions.get(identifier)?.value[theme],\n              theme\n            );\n          }\n          // If that didn't work, try a default value\n          if (!aliasValue) {\n            aliasValue = evaluateTokenExpression(\n              identifier,\n              gTokenDefinitions.get(qualifiedToken)?.value['_'],\n              theme\n            );\n          }\n        }\n        return aliasValue ?? getSuggestion(identifier, gTokenDefinitions);\n      },\n    });\n    gRecursiveEvaluationStack.pop();\n\n    return result;\n  } catch (err) {\n    if (!gErroredTokens.includes(qualifiedToken)) {\n      gErroredTokens.push(qualifiedToken);\n      error([\n        terminal.error('Syntax error') +\n          ` in \"${qualifiedToken + \": '\" + expression}\\'\"`,\n        err.message,\n      ]);\n    }\n  }\n  return undefined;\n}\n\n/**\n * Process an object literal that contains a group of tokens\n *\n * @param tokenFile - A parsed token file\n * @param groupPath - A dot separated path to this group, if not at root\n * @param tokens - A key/value map of token names and values\n */\nfunction processTokenGroup(\n  tokenFile: TokenFile,\n  groupPath: string,\n  tokens: Record<string, string | TokenDefinition | TokenGroup>\n): void {\n  throwErrorIf(\n    Array.isArray(tokens),\n    ErrorCode.UnexpectedTokensArray,\n    terminal.link('tokens-as-array')\n  );\n\n  if (!gGroups.has(groupPath)) {\n    gGroups.set(groupPath, {});\n  }\n  Object.keys(tokens).forEach((token) => {\n    const tokenPath = (groupPath ? groupPath + '.' : '') + token;\n    throwErrorIf(\n      !/^[a-zA-Z_-][a-zA-Z0-9_-]*$/.test(token),\n      ErrorCode.InvalidTokenName,\n      tokenPath\n    );\n    throwErrorIf(!tokens[token], ErrorCode.InvalidTokenValue, token);\n    try {\n      const normalizedToken = normalizeToken(\n        tokenFile.theme ?? gConfig.defaultTheme,\n        tokens[token] as string | TokenDefinition\n      );\n      if (!normalizedToken) {\n        // If it's not a token, it's a group of tokens\n        processTokenGroup(tokenFile, tokenPath, tokens[token] as TokenGroup);\n      } else {\n        if (!gTokenDefinitions.has(tokenPath)) {\n          gTokenDefinitions.set(tokenPath, normalizedToken);\n        } else {\n          // Merge the new definition with the previous one\n          const mergedToken = gTokenDefinitions.get(tokenPath);\n          mergeObject(mergedToken, normalizedToken);\n          gTokenDefinitions.set(tokenPath, mergedToken);\n        }\n      }\n    } catch (err) {\n      throw new Error(`${tokenPath}: \"${tokens[token]}\"\\n${err.message}`);\n    }\n  });\n}\n\n/**\n * @param  f    - path to a file or directory. If a directory,\n * its content are recursively walked and parsed\n *\n * The result of the processing is accumulated in gTokenDefinitions.\n *\n */\nfunction processPath(f: string): void {\n  const errors: string[] = [];\n  f = path.resolve(path.normalize(f));\n\n  // Avoid processing the same file (or directory) more than once\n  if (gProcessedFiles.includes(f)) return;\n  gProcessedFiles.push(f);\n\n  // If the path to process is a directory, process (recursively) all the\n  // token files it contains.\n  if (fs.lstatSync(f).isDirectory()) {\n    glob.sync(f + '/**/*' + gConfig.tokenFileExt).forEach(processPath);\n    return;\n  }\n\n  //\n  // 1. Read the token file\n  //\n\n  let tokenFile: TokenFile;\n\n  try {\n    const content = fs.readFileSync(f, 'utf8');\n    if (/^\\.json/.test(path.extname(f))) {\n      // If the extension is \".json\", \".jsonc\", \".json5\", etc.., attempt to read it as a JSON5 file\n      tokenFile = json5.parse(content);\n    } else {\n      tokenFile = yaml.parse(content);\n    }\n  } catch (err) {\n    errors.push((err.name ? err.name + ': ' : '') + err.message);\n  }\n\n  //\n  // 2. Process any 'import' directive\n  //\n  if (tokenFile?.import) {\n    if (typeof tokenFile.import === 'string') {\n      tokenFile.import = [tokenFile.import];\n    }\n    if (Array.isArray(tokenFile.import)) {\n      tokenFile.import.forEach((x: any) => {\n        let resolvedPath = f;\n        try {\n          resolvedPath = resolveFrom(path.parse(f).dir, x);\n          processPath(resolvedPath);\n        } catch (err) {\n          errors.push(`option \"import: ${x}\"`);\n          if (err.code === 'MODULE_NOT_FOUND') {\n            errors.push(\n              'Module not found.' +\n                (x.slice(0, 2) === './'\n                  ? ''\n                  : `\\nTo import as a file, use a relative path: \"./${x}\"`)\n            );\n          } else if (err.code === 'ENOENT') {\n            errors.push(\n              '→ ' + terminal.path(resolvedPath) + '\\nFile not found.'\n            );\n          } else {\n            errors.push(err.message);\n          }\n        }\n      });\n    } else {\n      errors.push('Option \"import\" should be a path or an array of paths');\n    }\n  }\n\n  if (\n    tokenFile &&\n    gConfig.verbose &&\n    (tokenFile['imports'] ||\n      tokenFile['extends'] ||\n      tokenFile['include'] ||\n      tokenFile['includes']) &&\n    !tokenFile.import\n  ) {\n    log(\n      terminal.warning() +\n        terminal.path(path.relative('', f)) +\n        `\\n${terminal.warning(\n          'Warning:'\n        )} use the \\`\"import\"\\` property to import other token files`\n    );\n  }\n\n  //\n  // 3. Process group declarations\n  //\n  if (tokenFile?.groups) {\n    Object.keys(tokenFile.groups).forEach((group) => {\n      if (gGroups.has(group)) {\n        const info = gGroups.get(group);\n        info.name = tokenFile.groups[group].name ?? info.name;\n        info.comment =\n          (info.comment ? info.comment + '\\n' : '') +\n          tokenFile.groups[group].comment;\n        info.remarks =\n          (info.remarks ? info.remarks + '\\n' : '') +\n          tokenFile.groups[group].remarks;\n        gGroups.set(group, info);\n      } else {\n        gGroups.set(group, tokenFile.groups[group]);\n      }\n    });\n  }\n\n  //\n  // 4. Process any token declaration\n  //\n  if (tokenFile?.tokens) {\n    throwErrorIf(\n      typeof tokenFile.tokens !== 'object',\n      ErrorCode.UnexpectedTokensType\n    );\n    try {\n      processTokenGroup(tokenFile, '', tokenFile.tokens);\n    } catch (err) {\n      errors.push(err.message);\n    }\n  }\n\n  //\n  // 5. Display any accumulated errors\n  //\n  if (gConfig.verbose && errors.length === 0) {\n    log(\n      terminal.success() +\n        '← ' +\n        terminal.path(\n          process.env.TEST ? path.basename(f) : path.relative('', f)\n        )\n    );\n  }\n  if (errors.length > 0) {\n    error([\n      terminal.error() +\n        '← ' +\n        terminal.path(\n          process.env.TEST ? path.basename(f) : path.relative('', f)\n        ),\n      ...errors,\n    ]);\n  }\n}\n\nfunction areThemesValid(): boolean {\n  // Filter out themes\n  if (gConfig.themes?.length > 0) {\n    gThemes = gThemes.filter((x) => gConfig.themes.includes(x));\n  }\n\n  // Check\n  gThemes.forEach((theme) => {\n    let count = 0;\n    gTokenDefinitions.forEach((entry, _token) => {\n      if (typeof entry.value[theme] !== 'undefined') {\n        count += 1;\n      }\n    });\n    if (count === 0) {\n      gThemes.splice(gThemes.indexOf(theme), 1);\n    }\n  });\n\n  if (gThemes.length === 0 || gTokenDefinitions.size === 0) {\n    error([\n      terminal.error('No tokens found.'),\n      `Token files should have a \"${'tokens'}\" property`,\n      terminal.link('../guide'),\n    ]);\n    return false;\n  }\n\n  return true;\n}\n\nfunction getFormat(formatName: string): Format {\n  const result: Format = {\n    fileHeader: DEFAULT_FILE_HEADER,\n    formatFilename: function ({\n      theme,\n      basename,\n    }: {\n      theme: string;\n      basename: string;\n    }): string {\n      return basename + (!theme ? '' : '-' + theme);\n    },\n    handlebarsHelpers: { ...gConfig.handlebarsHelpers },\n    render: (_context: RenderContext): string =>\n      'Expected a render() function in the Format definition.',\n  };\n\n  //\n  // 1. Check that the format exists\n  //\n  throwErrorIf(\n    !gConfig.formats[formatName],\n    ErrorCode.UnknownFormat,\n    formatName,\n    getSuggestion(formatName, gConfig.formats)\n  );\n\n  //\n  // 2. If this format extends another format,\n  //    merge the base format\n  //\n  const baseFormat = gConfig.formats[formatName].extends;\n  if (baseFormat) {\n    throwErrorIf(\n      !gConfig.formats[baseFormat],\n      ErrorCode.UnknownFormat,\n      baseFormat,\n      getSuggestion(baseFormat, gConfig.formats)\n    );\n\n    mergeObject(result, gConfig.formats[baseFormat]);\n  }\n\n  //\n  // 3. Add the override from this format\n  //\n  mergeObject(result, gConfig.formats[formatName]);\n\n  //\n  // 4. Register the handlebar helpers\n  //\n\n  // A handlebarsHelper can be defined:\n  // - in a config file\n  // - passed in as options to chromatic()\n  // - in a format definition\n\n  Object.keys(result.handlebarsHelpers).forEach((helper) => {\n    handlebars.registerHelper(helper, result.handlebarsHelpers[helper]);\n  });\n\n  return result;\n}\n\nfunction renderFile(\n  format: Format,\n  themes: string[],\n  filepath: string\n): string {\n  const tokens = [];\n  gTokenDefinitions.forEach((def, token) => {\n    Object.keys(def.value).forEach((tokenTheme) => {\n      if (themes.includes(tokenTheme)) {\n        tokens.push(tokenTheme === '_' ? token : token + '.' + tokenTheme);\n      }\n    });\n  });\n\n  //\n  // 1. Aggregate the tokens by group\n  //\n  const tokensByGroup = [];\n\n  gGroups.forEach((info, group) => {\n    const groupTokens = [...gTokenDefinitions].filter(([token, _def]) =>\n      group ? token.startsWith(group + '.') : !/\\./.test(token)\n    );\n    tokensByGroup.push({\n      groupId: group,\n      groupInfo: info,\n      tokens: groupTokens.map(([tokenId, tokenDefinition]) => {\n        return {\n          tokenId,\n          tokenDefinition,\n          themes: themes\n            .map((theme) => {\n              const qualifiedToken =\n                tokenId + (theme === '_' ? '' : '.' + theme);\n              return {\n                theme: theme,\n                tokenName: qualifiedToken,\n                tokenValue: gTokenValues.get(qualifiedToken),\n              };\n            })\n            .filter((x) => x.tokenValue),\n        };\n      }),\n    });\n  });\n\n  //\n  // 2. Aggregate the tokens by theme\n  //\n  const tokensByTheme = {};\n  gTokenDefinitions.forEach((def, tokenId) => {\n    if (Object.keys(def.value).length > 1) {\n      Object.keys(def.value).forEach((theme) => {\n        if (!tokensByTheme[theme]) tokensByTheme[theme] = [];\n        const qualifiedToken = tokenId + (theme === '_' ? '' : '.' + theme);\n        tokensByTheme[theme].push({\n          tokenId: tokenId,\n          tokenName: qualifiedToken,\n          tokenDefinition: def,\n          tokenValue: gTokenValues.get(qualifiedToken),\n        });\n      });\n    } else {\n      const theme = Object.keys(def.value)[0];\n      const qualifiedToken = tokenId + (theme === '_' ? '' : '.' + theme);\n      if (!tokensByTheme['']) tokensByTheme[''] = [];\n      tokensByTheme[''].push({\n        tokenId: tokenId,\n        tokenName: qualifiedToken,\n        tokenDefinition: def,\n        tokenValue: gTokenValues.get(qualifiedToken),\n      });\n    }\n  });\n\n  //\n  // 3. Render the file\n  //\n  return format.render({\n    filepath,\n    fileHeader: format.fileHeader,\n    themes: Object.keys(tokensByTheme).map((theme) => {\n      return {\n        theme,\n        isDefaultTheme: theme === '_',\n        tokens: tokensByTheme[theme],\n      };\n    }),\n    groups: tokensByGroup,\n    renderTemplate: (template: string, context: RenderContext): string =>\n      handlebars.compile(template.replace(/\\r\\n/g, '\\n'))(context),\n  });\n}\n\nfunction render(\n  baseOutputPath: string,\n  format: Format\n): { [filename: string]: string } {\n  const result = {};\n  let outputPath = '';\n\n  // Check that there are tokens in each of the themes\n  if (!areThemesValid()) return;\n\n  const pathRecord = (baseOutputPath && path.parse(baseOutputPath)) ?? {\n    name: 'tokens',\n  };\n\n  if (gConfig.splitOutput) {\n    // Output one file per theme\n    gThemes.forEach((theme) => {\n      outputPath = path.format({\n        dir: pathRecord.dir,\n        name: format.formatFilename({\n          theme: theme,\n          basename: pathRecord.name,\n        }),\n        ext: format.ext,\n      });\n      result[outputPath] = renderFile(format, [theme], outputPath);\n    });\n  } else {\n    // Output a single file for all themes\n    outputPath = path.format({\n      dir: pathRecord.dir,\n      name: format.formatFilename({\n        theme: '',\n        basename: pathRecord.name,\n      }),\n      ext: format.ext,\n    });\n    result[outputPath] = renderFile(format, gThemes, outputPath);\n  }\n\n  return result;\n}\n\nfunction writeOutputFile(content: string, outputPath: string): void {\n  const dirname = path.dirname(outputPath);\n  if (!fs.existsSync(dirname)) {\n    fs.mkdirsSync(dirname);\n  }\n  fs.writeFileSync(outputPath, content);\n  if (gConfig.verbose || gWatching) {\n    log(\n      terminal.success() +\n        (gWatching ? terminal.time() + ' ' : '') +\n        '→ ' +\n        terminal.path(path.relative('', outputPath))\n    );\n  }\n}\n\n/**\n * @returns A map where the key is a filename and the value is\n * the content of the file.\n */\nfunction build(\n  paths: string[],\n  options: Options\n): { [filename: string]: string } {\n  //\n  // 1. Process each file or directory\n  //\n  //    Parse the token files and accumulate the qualified token names\n  //    (dot-separated paths) with their normalized definition (TokenDefinition)\n  //    in gTokenDefinitions (in a normalized definition, the default theme has been applied, replacing '_')\n  //\n  gWatching = options?.watching ?? false;\n\n  gThemes = [];\n  gTokenDefinitions = new Map();\n  gGroups = new Map();\n  gTokenValues = new Map();\n  gRecursiveEvaluationStack = [];\n  gProcessedFiles = [];\n  gErroredTokens = [];\n\n  paths.forEach((x: string): void => {\n    const files = glob.sync(x);\n    if (files.length === 0) {\n      error(terminal.error('File not found: ') + terminal.path(x));\n      return;\n    }\n    files.forEach(processPath);\n  });\n\n  //\n  // 2. Evaluate the tokens\n  //\n\n  // 2.1 First pass\n  // Evaluate the token value expressions, including aliases,\n  // except in strings. Store the result in gTokenValues.\n  try {\n    gTokenDefinitions.forEach((def, token) => {\n      Object.keys(def.value).forEach((theme) => {\n        const qualifiedToken = token + (theme === '_' ? '' : '.' + theme);\n        const value =\n          evaluateTokenExpression(\n            qualifiedToken,\n            def.value[theme],\n            gConfig.defaultTheme\n          ) ?? new StringValue(def.value[theme]);\n\n        gTokenValues.set(qualifiedToken, value);\n\n        if (def.type && value.type() != def.type) {\n          log(\n            terminal.warning('Warning:') +\n              ` Type mismatch. Expected \\`${\n                def.type\n              }\\` but got \\`${value.type()}\\` for \"${qualifiedToken}\" token`\n          );\n        }\n\n        // @todo: cross-check category\n      });\n    });\n\n    // 2.2\n    // For any string that may still contain an alias, replace the\n    // alias reference with its value\n    gTokenValues.forEach((value, _token) => {\n      if (isString(value)) {\n        value.value = value.value.replace(/{[a-zA-Z0-9\\._-]+}/g, (match) => {\n          const alias = match.slice(1, -1);\n          if (gTokenValues.has(alias)) {\n            return gTokenValues.get(alias).css();\n          }\n\n          error(\n            terminal.error('Unresolved alias. ') +\n              `Cannot find token \"${match}\"` +\n              getSuggestion(alias, gTokenValues)\n          );\n          return match;\n        });\n      }\n    });\n\n    // 2.3 Calculate missing values for each theme\n    gTokenDefinitions.forEach((def, token) => {\n      gThemes.forEach((theme) => {\n        if (theme !== '_' && typeof def.value[theme] === 'undefined') {\n          const qualifiedToken = token + '.' + theme;\n          const value =\n            evaluateTokenExpression(qualifiedToken, def.value['_'], theme) ??\n            new StringValue(def.value['_']);\n          gTokenValues.set(qualifiedToken, value);\n        }\n      });\n    });\n\n    // 2.4 Eliminate any themed values that are the same as base\n    // Steps 2.3 and 2.4 are necessary to handle this case:\n    /* ``` \n    hue:\n        value:\n            _: \"0deg\"\n            dark: \"10deg\"\n    primary: \"hsl({hue}, 50%, 50%)\"\n*/\n    // Since the expression to calculate value depends on a token that does\n    // have a theme variant, primary also needs to have a theme variant\n    gTokenDefinitions.forEach((_def, token) => {\n      gThemes.forEach((theme) => {\n        if (theme !== '_') {\n          const qualifiedToken = token + '.' + theme;\n          if (\n            gTokenValues.get(token)?.equals(gTokenValues.get(qualifiedToken))\n          ) {\n            gTokenValues.delete(qualifiedToken);\n          }\n        }\n      });\n    });\n\n    // 2.5 Validate that all the types for a given definition are consistent\n    gTokenDefinitions.forEach((def, token) => {\n      const types = Object.keys(def.value).reduce(\n        (acc: string[], x: string): string[] => {\n          const qualifiedToken = x === '_' ? token : token + '.' + x;\n          if (!acc.includes(gTokenValues.get(qualifiedToken)?.type()))\n            acc.push(gTokenValues.get(qualifiedToken)?.type());\n          return acc;\n        },\n        []\n      );\n      // If there's more than one type for the values of this definition,\n      // throw\n      throwErrorIf(types.length > 1, ErrorCode.InconsistentTokenType, token);\n    });\n\n    //\n    // 3. Format and output\n    //\n    // 3.1 Determine the output format\n\n    const format = getFormat(gConfig.outputFormat);\n\n    // Override format settings from options\n    format.fileHeader = options.header ?? format.fileHeader;\n\n    //\n    // 3.2. Render the properties\n    //\n    const outputPath = options?.output && path.resolve(options.output);\n    const content = render(outputPath, format);\n\n    //\n    // 3.3. Write the files\n    //\n    if (content && !options?.dryRun) {\n      if (!outputPath) {\n        return content;\n      } else {\n        if (gConfig.verbose) {\n          let themesMessage = '';\n          if (gThemes.length !== 1 || gThemes[0] !== '_') {\n            if (gThemes.length === 1) {\n              themesMessage = `for theme \"${gThemes[0]}\"`;\n            } else {\n              themesMessage =\n                'for themes ' + gThemes.map((x) => '\"' + x + '\"').join(', ');\n            }\n          }\n          log(\n            `    Writing ${terminal.string(\n              gConfig.outputFormat\n            )} format ${themesMessage}`\n          );\n        }\n        Object.keys(content).forEach((file) => {\n          writeOutputFile(content[file], file);\n        });\n      }\n    }\n  } catch (err) {\n    error(terminal.error(err.message));\n  }\n  return {};\n}\n\n/**\n * The main entry point of Chromatic.\n *\n * @param paths - A list of files or directories to process\n * @returns If the result is a single file, the content of the\n * file as a string. Otherwise, a map of key/values, where the\n * key is the file name and the value is the content.\n *\n */\n\nexport function chromatic(\n  paths: string | string[],\n  options: Options\n): { [filename: string]: string } {\n  if (typeof paths === 'string') {\n    paths = [paths];\n  }\n\n  //\n  // 1. Load from 'standard' config locations\n  //\n  let configResult = configParser.search();\n  if (!(configResult?.isEmpty ?? true)) {\n    mergeObject(gConfig, configResult.config);\n  }\n\n  //\n  // 2. If a config file is specified, merge with previous config\n  //\n  if (options?.config) {\n    configResult = configParser.load(options.config);\n    if (!(configResult?.isEmpty ?? true)) {\n      mergeObject(gConfig, configResult.config);\n    }\n  }\n\n  //\n  // 3. If options are specified, merge with previous config\n  //\n  if (options?.themes) {\n    if (typeof options.themes === 'string') {\n      gConfig.themes = options.themes.split(',').map((x: string) => x.trim());\n    } else if (Array.isArray(options.themes)) {\n      gConfig.themes = [...options.themes];\n    }\n  }\n\n  gIgnoreErrors = options?.ignoreErrors ?? false;\n\n  // Configure the console/logger\n  const messages: string[] = [];\n  if (typeof options?.console === 'string') {\n    if (options?.console === 'log') {\n      terminal.useColor(false);\n      gConfig.console = {\n        log: (m: string): void => {\n          messages.push(m);\n        },\n        error: (m: string): void => {\n          messages.push(m);\n        },\n      };\n    }\n  } else {\n    gConfig.console = options?.console ?? {\n      // Output \"log\" (i.e. warnings) message to stdout (console.error)\n      log: (m: string): void => console.error(m),\n      error: (m: string): void => console.error(m),\n    };\n  }\n\n  if (!gConfig.themes) gConfig.themes = [];\n\n  gConfig.tokenFileExt =\n    options?.tokenFileExt ?? gConfig?.tokenFileExt ?? 'yaml';\n\n  gConfig.verbose = options?.verbose ?? gConfig?.verbose ?? false;\n\n  gConfig.splitOutput = options.splitOutput;\n\n  gConfig.outputFormat = options?.format ?? gConfig?.outputFormat ?? '';\n\n  if (!gConfig.outputFormat) {\n    // Try to guess the format based on the extension of the output file\n    const fileExt = options?.output && path.extname(options?.output);\n    if (fileExt) {\n      const matchingExtensions = Object.keys(gConfig.formats).filter(\n        (x) =>\n          gConfig.formats[x].ext === fileExt ||\n          gConfig.formats[gConfig.formats[x]?.extends]?.ext\n      );\n      if (matchingExtensions.length === 1) {\n        gConfig.outputFormat = matchingExtensions[0];\n      } else {\n        // Multiple (or no) format can output to this extension.\n        // If there is one whose name is exactly the extension, use it.\n        if (gConfig.formats[fileExt.slice(1)]) {\n          gConfig.outputFormat = fileExt.slice(1);\n        } else if (matchingExtensions.length > 1) {\n          error([\n            terminal.error('Ambiguous format. ') +\n              `Use ${terminal.keyword(\n                '--format'\n              )} to indicate which output format to use.`,\n            `Did you mean \\`${matchingExtensions.join(', ')}\\`?`,\n          ]);\n        }\n      }\n    }\n\n    if (gConfig.outputFormat) {\n      if (gConfig.verbose) {\n        log(\n          terminal.warning() +\n            `Setting the format to \"gConfig.outputFormat\" based on the output file extension. ` +\n            'Use `--format` to indicate which output format to use.'\n        );\n      }\n    } else {\n      gConfig.outputFormat = 'yaml';\n      log(\n        terminal.warning('Format not specified.') +\n          ` Using \"${terminal.keyword('yaml')}\". ` +\n          `Use ${terminal.keyword(\n            '--format'\n          )} to indicate which output format to use.`\n      );\n    }\n  }\n\n  // Merge any custom handlebars helpers\n  mergeObject(gConfig.handlebarsHelpers, options?.handlebarsHelpers);\n\n  const result = build(paths, options);\n  if (messages.length > 0) {\n    result['stderr'] = messages.join('\\n');\n  }\n  return result;\n}\n\nmergeObject(gConfig, DefaultFormatters);\nmergeObject(gConfig, WebFormats);\nmergeObject(gConfig, GenericFormats);\nmergeObject(gConfig, StyleGuideFormat);\n\nmodule.exports = chromatic;\n","const pkg = require('./package.json');\nrequire('please-upgrade-node')(pkg);\n\nimport { chromatic } from './chromatic';\nimport { terminal } from './terminal';\nconst fs = require('fs-extra');\nconst path = require('path');\nconst updateNotifier = require('update-notifier');\n\nconst chokidar = require('chokidar');\n\nfunction logResult(result: { [file: string]: string }): void {\n  console.log(\n    Object.keys(result)\n      .map(\n        (x) =>\n          (x === 'stderr' ? terminal.error() : terminal.success()) +\n          '>>>> ' +\n          terminal.path(x) +\n          '\\n' +\n          result[x]\n      )\n      .join('\\n')\n  );\n}\n\nfunction build(argv): void {\n  if (typeof process.stdin.isTTY !== 'undefined' && !process.stdin.isTTY) {\n    // The command was piped, e.g.\n    // `echo \"foo\" | chromatic`\n    process.stdin.setEncoding('utf-8');\n    let input = '';\n    process.stdin.on('readable', function () {\n      let chunk: string;\n      while ((chunk = process.stdin.read())) {\n        input += chunk;\n      }\n    });\n\n    process.stdin.on('end', function () {\n      logResult(chromatic(input, argv));\n    });\n  } else {\n    // The command was not piped\n    if (!argv['paths'] || argv['paths'].length < 1) {\n      console.error(\n        terminal.error() +\n          `Expected at least one path to a directory or token file.\\n` +\n          `    Use ${terminal.keyword(\n            argv.$0 + ' help'\n          )} for available options.\\n`,\n        `   Use ${terminal.keyword(\n          argv.$0 + ' example'\n        )} to create an example directory.`\n      );\n      process.exit(1);\n    }\n\n    if (argv.watch) {\n      chokidar.watch(argv['paths']).on('all', (_event: any, _path: string) => {\n        chromatic(argv['paths'], {\n          ...argv,\n          ...{ watching: true },\n        });\n        console.log(\n          terminal.time() +\n            ` ${terminal.dim(argv.$0)}: Waiting for changes...\\n${terminal.dim(\n              'Press Ctrl-C to exit.'\n            )}`\n        );\n      });\n    } else {\n      logResult(chromatic(argv['paths'], argv));\n    }\n  }\n}\n\nfunction buildOptions(yargs): void {\n  yargs\n    .positional('<path>', {\n      describe: 'Path to a token file or directory',\n      type: 'string',\n    })\n    .option('output', {\n      alias: 'o',\n      describe: 'Save output to path',\n      type: 'path',\n    })\n    .normalize('output')\n    .option('format', {\n      alias: 'f',\n      describe: 'Output format: css|sass|js|yaml|json',\n      type: 'string',\n    })\n    .option('header', {\n      describe: 'Content inserted at the to of the output file',\n      type: 'string',\n    })\n    .option('themes', {\n      describe: 'Comma separated list of themes to process',\n      type: 'string',\n    })\n    .option('split-output', {\n      describe:\n        'If there are multiple themes, output one file per theme. Otherwise the themes are combined in a single file.',\n      type: 'boolean',\n      default: false,\n    })\n    .option('token-file-ext', {\n      describe: 'Default file extension of token files',\n      type: 'string',\n      default: '.yaml',\n    })\n    .option('dry-run', {\n      describe:\n        \"Validate the token files, attempt to generate the specified file format, but don't output anything\",\n      conflicts: 'output',\n      type: 'boolean',\n    })\n    .option('config', {\n      describe: 'Load config file from path',\n      type: 'path',\n    })\n    .normalize('config')\n    .option('verbose', {\n      describe: 'Display additional information during processing',\n      type: 'boolean',\n    })\n    .option('no-color', {\n      describe: 'Suppress color output in terminal',\n      type: 'boolean',\n    })\n    .option('ignore-errors', {\n      alias: 'i',\n      describe: 'Attempt to continue when an error is encountered',\n      type: 'boolean',\n    })\n    .option('watch', {\n      describe: 'Watch for changes to the token files and rebuild',\n      type: 'boolean',\n    });\n}\n\nfunction example(argv): void {\n  const target = path.resolve(argv['example-directory'] ?? 'chromatic-example');\n  console.log('Creating an example in ' + path.relative('', target));\n  try {\n    fs.copySync('examples/basic', target, {\n      overwrite: false,\n      errorOnExist: true,\n    });\n    console.log(\n      'Now, try the example:\\n' +\n        '    ' +\n        terminal.keyword(\n          argv.$0 + ' ' + path.relative('', target) + ' -o ./build/tokens.scss'\n        ) +\n        '\\nor:\\n' +\n        '    ' +\n        terminal.keyword(\n          argv.$0 + ' ' + path.relative('', target) + ' -o ./build/tokens.html'\n        )\n    );\n  } catch (err) {\n    console.log(err.message);\n  }\n}\n\n// Display an update message if a more recent version of the package is\n// available.\nupdateNotifier({ pkg, shouldNotifyInNpmScript: true }).notify();\n\nrequire('yargs')\n  .usage('Usage: $0 file(s) [options]')\n  .example(\n    '$0 ./assets/tokens.yaml -o ./build/tokens.scss',\n    'Generate a Sass file from a design tokens YAML file'\n  )\n  .command(\n    ['* <paths..>', 'build <paths..>'],\n    'Build output files',\n    buildOptions,\n    build\n  )\n  .command(\n    'example [example-directory]',\n    'Create example directory',\n    (yargs) => {\n      yargs.positional('example-directory', {\n        describe: 'Example output directory',\n        type: 'string',\n      });\n    },\n    example\n  )\n  .command(\n    'help',\n    'Show help',\n    () => {\n      return;\n    },\n    (yargs) => yargs.help()\n  )\n\n  .help('h')\n  .alias('h', 'help')\n  .epilog(\n    'For more information, see https://github.com/arnog/chromatic/docs/guide.md'\n  )\n  .strict(true).argv;\n"],"names":["fs","handlebars","path","build"],"mappings":"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"}